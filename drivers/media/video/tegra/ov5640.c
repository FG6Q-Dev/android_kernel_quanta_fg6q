/*
 * kernel/drivers/media/video/tegra
 *
 * OV5640 sensor driver
 *
 * Copyright (C) 2011 NVIDIA Corporation
 *
 * This program is free software; you can redistribute it and/or modify
 * it under the terms of the GNU General Public License as published by
 * the Free Software Foundation; either version 2 of the License, or
 * (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful, but WITHOUT
 * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
 * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License for
 * more details.
 *
 * You should have received a copy of the GNU General Public License along
 * with this program; if not, write to the Free Software Foundation, Inc.,
 * 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.
 */

#include <linux/delay.h>
#include <linux/fs.h>
#include <linux/i2c.h>
#include <linux/miscdevice.h>
#include <linux/slab.h>
#include <linux/uaccess.h>
#include <linux/module.h>
#include <linux/regulator/consumer.h>
#include <media/ov5640.h>

struct ov5640_reg {
    u8  op;
    u16 addr;
    u8 val;
};

struct ov5640_info {
    int mode;
    struct ov5640_power_rail	power;
    struct i2c_client *i2c_client;
    struct ov5640_platform_data *pdata;
};

static struct ov5640_info *info;
static int initial = 0;
static u8 pre_wb_mode = OV5640_WhiteBalance_None;
static u8 pre_exposure = OV5640_Exposure_0;
static u8 pre_focus_mode = OV5640_FocusMode_Invalid;
static u8 pre_scene = OV5640_SceneMode_Invalid;

static struct ov5640_reg IQ_table[] = {
// AWB
    {OV5640_WRITE_REG_DATA8, 0x5180, 0xFF},
    {OV5640_WRITE_REG_DATA8, 0x5181, 0xF2},
    {OV5640_WRITE_REG_DATA8, 0x5182, 0x11},
    {OV5640_WRITE_REG_DATA8, 0x5183, 0x14},
    {OV5640_WRITE_REG_DATA8, 0x5184, 0x25},
    {OV5640_WRITE_REG_DATA8, 0x5185, 0x24},
    {OV5640_WRITE_REG_DATA8, 0x5186, 0x11},
    {OV5640_WRITE_REG_DATA8, 0x5187, 0x2A},
    {OV5640_WRITE_REG_DATA8, 0x5188, 0x0F},
    {OV5640_WRITE_REG_DATA8, 0x5189, 0x7B},
    {OV5640_WRITE_REG_DATA8, 0x518A, 0x5B},
    {OV5640_WRITE_REG_DATA8, 0x518B, 0xB8},
    {OV5640_WRITE_REG_DATA8, 0x518C, 0xB2},
    {OV5640_WRITE_REG_DATA8, 0x518D, 0x12},
    {OV5640_WRITE_REG_DATA8, 0x518E, 0x30},
    {OV5640_WRITE_REG_DATA8, 0x518F, 0x69},
    {OV5640_WRITE_REG_DATA8, 0x5190, 0x46},
    {OV5640_WRITE_REG_DATA8, 0x5191, 0xF8},
    {OV5640_WRITE_REG_DATA8, 0x5192, 0x04},
    {OV5640_WRITE_REG_DATA8, 0x5193, 0x70},
    {OV5640_WRITE_REG_DATA8, 0x5194, 0xF0},
    {OV5640_WRITE_REG_DATA8, 0x5195, 0xF0},
    {OV5640_WRITE_REG_DATA8, 0x5196, 0x03},
    {OV5640_WRITE_REG_DATA8, 0x5197, 0x01},
    {OV5640_WRITE_REG_DATA8, 0x5198, 0x07},
    {OV5640_WRITE_REG_DATA8, 0x5199, 0x45},
    {OV5640_WRITE_REG_DATA8, 0x519A, 0x04},
    {OV5640_WRITE_REG_DATA8, 0x519B, 0x00},
    {OV5640_WRITE_REG_DATA8, 0x519C, 0x04},
    {OV5640_WRITE_REG_DATA8, 0x519D, 0xC3},
    {OV5640_WRITE_REG_DATA8, 0x519E, 0x38},
// Gamma
    {OV5640_WRITE_REG_DATA8, 0x5481, 0x08},
    {OV5640_WRITE_REG_DATA8, 0x5482, 0x14},
    {OV5640_WRITE_REG_DATA8, 0x5483, 0x28},
    {OV5640_WRITE_REG_DATA8, 0x5484, 0x51},
    {OV5640_WRITE_REG_DATA8, 0x5485, 0x65},
    {OV5640_WRITE_REG_DATA8, 0x5486, 0x71},
    {OV5640_WRITE_REG_DATA8, 0x5487, 0x7D},
    {OV5640_WRITE_REG_DATA8, 0x5488, 0x87},
    {OV5640_WRITE_REG_DATA8, 0x5489, 0x91},
    {OV5640_WRITE_REG_DATA8, 0x548A, 0x9A},
    {OV5640_WRITE_REG_DATA8, 0x548B, 0xAA},
    {OV5640_WRITE_REG_DATA8, 0x548C, 0xB8},
    {OV5640_WRITE_REG_DATA8, 0x548D, 0xCD},
    {OV5640_WRITE_REG_DATA8, 0x548E, 0xDD},
    {OV5640_WRITE_REG_DATA8, 0x548F, 0xEA},
    {OV5640_WRITE_REG_DATA8, 0x5490, 0x1D},
// CMX
    {OV5640_WRITE_REG_DATA8, 0x5381, 0x1C},
    {OV5640_WRITE_REG_DATA8, 0x5382, 0x5A},
    {OV5640_WRITE_REG_DATA8, 0x5383, 0x06},
    {OV5640_WRITE_REG_DATA8, 0x5384, 0x0A},
    {OV5640_WRITE_REG_DATA8, 0x5385, 0x7E},
    {OV5640_WRITE_REG_DATA8, 0x5386, 0x89},
    {OV5640_WRITE_REG_DATA8, 0x5387, 0x7E},
    {OV5640_WRITE_REG_DATA8, 0x5388, 0x6C},
    {OV5640_WRITE_REG_DATA8, 0x5389, 0x10},
    {OV5640_WRITE_REG_DATA8, 0x538A, 0x01},
    {OV5640_WRITE_REG_DATA8, 0x538B, 0x98},
// Sharpness & denoise
    {OV5640_WRITE_REG_DATA8, 0x5300, 0x08},
    {OV5640_WRITE_REG_DATA8, 0x5301, 0x30},
    {OV5640_WRITE_REG_DATA8, 0x5302, 0x10},
    {OV5640_WRITE_REG_DATA8, 0x5303, 0x00},
    {OV5640_WRITE_REG_DATA8, 0x5304, 0x08},
    {OV5640_WRITE_REG_DATA8, 0x5305, 0x30},
    {OV5640_WRITE_REG_DATA8, 0x5306, 0x08},
    {OV5640_WRITE_REG_DATA8, 0x5307, 0x40},
    {OV5640_WRITE_REG_DATA8, 0x5309, 0x08},
    {OV5640_WRITE_REG_DATA8, 0x530A, 0x30},
    {OV5640_WRITE_REG_DATA8, 0x530B, 0x04},
    {OV5640_WRITE_REG_DATA8, 0x530C, 0x06},
// LensC
    {OV5640_WRITE_REG_DATA8, 0x5800, 0x3D},
    {OV5640_WRITE_REG_DATA8, 0x5801, 0x19},
    {OV5640_WRITE_REG_DATA8, 0x5802, 0x15},
    {OV5640_WRITE_REG_DATA8, 0x5803, 0x14},
    {OV5640_WRITE_REG_DATA8, 0x5804, 0x1A},
    {OV5640_WRITE_REG_DATA8, 0x5805, 0x3F},
    {OV5640_WRITE_REG_DATA8, 0x5806, 0x0A},
    {OV5640_WRITE_REG_DATA8, 0x5807, 0x0B},
    {OV5640_WRITE_REG_DATA8, 0x5808, 0x08},
    {OV5640_WRITE_REG_DATA8, 0x5809, 0x08},
    {OV5640_WRITE_REG_DATA8, 0x580A, 0x0A},
    {OV5640_WRITE_REG_DATA8, 0x580B, 0x0C},
    {OV5640_WRITE_REG_DATA8, 0x580C, 0x09},
    {OV5640_WRITE_REG_DATA8, 0x580D, 0x04},
    {OV5640_WRITE_REG_DATA8, 0x580E, 0x00},
    {OV5640_WRITE_REG_DATA8, 0x580F, 0x00},
    {OV5640_WRITE_REG_DATA8, 0x5810, 0x04},
    {OV5640_WRITE_REG_DATA8, 0x5811, 0x0B},
    {OV5640_WRITE_REG_DATA8, 0x5812, 0x09},
    {OV5640_WRITE_REG_DATA8, 0x5813, 0x05},
    {OV5640_WRITE_REG_DATA8, 0x5814, 0x00},
    {OV5640_WRITE_REG_DATA8, 0x5815, 0x00},
    {OV5640_WRITE_REG_DATA8, 0x5816, 0x05},
    {OV5640_WRITE_REG_DATA8, 0x5817, 0x09},
    {OV5640_WRITE_REG_DATA8, 0x5818, 0x0B},
    {OV5640_WRITE_REG_DATA8, 0x5819, 0x0B},
    {OV5640_WRITE_REG_DATA8, 0x581A, 0x08},
    {OV5640_WRITE_REG_DATA8, 0x581B, 0x08},
    {OV5640_WRITE_REG_DATA8, 0x581C, 0x09},
    {OV5640_WRITE_REG_DATA8, 0x581D, 0x0D},
    {OV5640_WRITE_REG_DATA8, 0x581E, 0x3F},
    {OV5640_WRITE_REG_DATA8, 0x581F, 0x1D},
    {OV5640_WRITE_REG_DATA8, 0x5820, 0x15},
    {OV5640_WRITE_REG_DATA8, 0x5821, 0x13},
    {OV5640_WRITE_REG_DATA8, 0x5822, 0x20},
    {OV5640_WRITE_REG_DATA8, 0x5823, 0x3F},
    {OV5640_WRITE_REG_DATA8, 0x5824, 0x4C},
    {OV5640_WRITE_REG_DATA8, 0x5825, 0x08},
    {OV5640_WRITE_REG_DATA8, 0x5826, 0x0C},
    {OV5640_WRITE_REG_DATA8, 0x5827, 0x0A},
    {OV5640_WRITE_REG_DATA8, 0x5828, 0x4C},
    {OV5640_WRITE_REG_DATA8, 0x5829, 0x2C},
    {OV5640_WRITE_REG_DATA8, 0x582A, 0x26},
    {OV5640_WRITE_REG_DATA8, 0x582B, 0x24},
    {OV5640_WRITE_REG_DATA8, 0x582C, 0x26},
    {OV5640_WRITE_REG_DATA8, 0x582D, 0x2A},
    {OV5640_WRITE_REG_DATA8, 0x582E, 0x0C},
    {OV5640_WRITE_REG_DATA8, 0x582F, 0x42},
    {OV5640_WRITE_REG_DATA8, 0x5830, 0x40},
    {OV5640_WRITE_REG_DATA8, 0x5831, 0x22},
    {OV5640_WRITE_REG_DATA8, 0x5832, 0x2A},
    {OV5640_WRITE_REG_DATA8, 0x5833, 0x2C},
    {OV5640_WRITE_REG_DATA8, 0x5834, 0x26},
    {OV5640_WRITE_REG_DATA8, 0x5835, 0x26},
    {OV5640_WRITE_REG_DATA8, 0x5836, 0x06},
    {OV5640_WRITE_REG_DATA8, 0x5837, 0x4A},
    {OV5640_WRITE_REG_DATA8, 0x5838, 0x28},
    {OV5640_WRITE_REG_DATA8, 0x5839, 0x28},
    {OV5640_WRITE_REG_DATA8, 0x583A, 0x2A},
    {OV5640_WRITE_REG_DATA8, 0x583B, 0x28},
    {OV5640_WRITE_REG_DATA8, 0x583C, 0x28},
    {OV5640_WRITE_REG_DATA8, 0x583D, 0xCE},
// NightMode
    {OV5640_WRITE_REG_DATA8, 0x3A00, 0x7C},
    {OV5640_WRITE_REG_DATA8, 0x3A02, 0x09},
    {OV5640_WRITE_REG_DATA8, 0x3A03, 0x9C},
    {OV5640_WRITE_REG_DATA8, 0x3A14, 0x09},
    {OV5640_WRITE_REG_DATA8, 0x3A15, 0x9C},
    {OV5640_WRITE_REG_DATA8, 0x3A17, 0x02},
// AE range
    {OV5640_WRITE_REG_DATA8, 0x3A0F, 0x30},
    {OV5640_WRITE_REG_DATA8, 0x3A10, 0x28},
    {OV5640_WRITE_REG_DATA8, 0x3A1B, 0x30},
    {OV5640_WRITE_REG_DATA8, 0x3A1E, 0x28},
    {OV5640_WRITE_REG_DATA8, 0x3A11, 0x61},
    {OV5640_WRITE_REG_DATA8, 0x3A1F, 0x10},
// Gain
    {OV5640_WRITE_REG_DATA8, 0x3A18, 0x00},
    {OV5640_WRITE_REG_DATA8, 0x3A19, 0xC0},
// AE weighty
    {OV5640_WRITE_REG_DATA8, 0x5688, 0x62},
    {OV5640_WRITE_REG_DATA8, 0x5689, 0x26},
    {OV5640_WRITE_REG_DATA8, 0x568A, 0xe6},
    {OV5640_WRITE_REG_DATA8, 0x568B, 0x6E},
    {OV5640_WRITE_REG_DATA8, 0x568C, 0xEA},
    {OV5640_WRITE_REG_DATA8, 0x568D, 0xAE},
    {OV5640_WRITE_REG_DATA8, 0x568E, 0xA6},
    {OV5640_WRITE_REG_DATA8, 0x568F, 0x6A},
// Reducing lowlux saturation
    {OV5640_WRITE_REG_DATA8, 0x5580, 0x02},//Sat enable
    {OV5640_WRITE_REG_DATA8, 0x5588, 0x40},//enable UV adj
    {OV5640_WRITE_REG_DATA8, 0x5583, 0x40},//offset high - 100%
    {OV5640_WRITE_REG_DATA8, 0x5584, 0x40},//offset low - 80%
    {OV5640_WRITE_REG_DATA8, 0x5589, 0x38},
    {OV5640_WRITE_REG_DATA8, 0x558A, 0x00},
    {OV5640_WRITE_REG_DATA8, 0x558B, 0xF8},
// End IQ
    {OV5640_TABLE_END, 0x0000, 0x00}
};

static struct ov5640_reg mode_1280x960[] = {
/* PLL Control MIPI bit rate/lane = 448MHz, 16-bit mode.
 * Output size: 1304x972 (0, 0) - (2623, 1951),
 * Line Length = 1886, Frame Length = 990.
 */
    {OV5640_WRITE_REG_DATA8, 0x3103, 0x11},
    //{OV5640_WRITE_REG_DATA8, 0x3008, 0x82},
    {OV5640_WAIT_MS, 0x0000, 5},
    {OV5640_WRITE_REG_DATA8, 0x3008, 0x42},
    {OV5640_WRITE_REG_DATA8, 0x3103, 0x03},
    {OV5640_WRITE_REG_DATA8, 0x3017, 0x00},
    {OV5640_WRITE_REG_DATA8, 0x3018, 0x00},
    {OV5640_WRITE_REG_DATA8, 0x3034, 0x18},
    {OV5640_WRITE_REG_DATA8, 0x3035, 0x21},
    {OV5640_WRITE_REG_DATA8, 0x3036, 0x70},
    {OV5640_WRITE_REG_DATA8, 0x3037, 0x13},
    {OV5640_WRITE_REG_DATA8, 0x3108, 0x01},
    {OV5640_WRITE_REG_DATA8, 0x3630, 0x36},
    {OV5640_WRITE_REG_DATA8, 0x3631, 0x0e},
    {OV5640_WRITE_REG_DATA8, 0x3632, 0xe2},
    {OV5640_WRITE_REG_DATA8, 0x3633, 0x12},
    {OV5640_WRITE_REG_DATA8, 0x3621, 0xe0},
    {OV5640_WRITE_REG_DATA8, 0x3704, 0xa0},
    {OV5640_WRITE_REG_DATA8, 0x3703, 0x5a},
    {OV5640_WRITE_REG_DATA8, 0x3715, 0x78},
    {OV5640_WRITE_REG_DATA8, 0x3717, 0x01},
    {OV5640_WRITE_REG_DATA8, 0x370b, 0x60},
    {OV5640_WRITE_REG_DATA8, 0x3705, 0x1a},
    {OV5640_WRITE_REG_DATA8, 0x3905, 0x02},
    {OV5640_WRITE_REG_DATA8, 0x3906, 0x10},
    {OV5640_WRITE_REG_DATA8, 0x3901, 0x0a},
    {OV5640_WRITE_REG_DATA8, 0x3731, 0x12},
    {OV5640_WRITE_REG_DATA8, 0x3600, 0x08},
    {OV5640_WRITE_REG_DATA8, 0x3601, 0x33},
    {OV5640_WRITE_REG_DATA8, 0x302d, 0x60},
    {OV5640_WRITE_REG_DATA8, 0x3620, 0x52},
    {OV5640_WRITE_REG_DATA8, 0x371b, 0x20},
    {OV5640_WRITE_REG_DATA8, 0x471c, 0x50},
    {OV5640_WRITE_REG_DATA8, 0x3a13, 0x43},
    {OV5640_WRITE_REG_DATA8, 0x3a18, 0x00},
    {OV5640_WRITE_REG_DATA8, 0x3a19, 0xf8},
    {OV5640_WRITE_REG_DATA8, 0x3635, 0x13},
    {OV5640_WRITE_REG_DATA8, 0x3636, 0x03},
    {OV5640_WRITE_REG_DATA8, 0x3634, 0x40},
    {OV5640_WRITE_REG_DATA8, 0x3622, 0x01},
    {OV5640_WRITE_REG_DATA8, 0x3c01, 0x34},
    {OV5640_WRITE_REG_DATA8, 0x3c04, 0x28},
    {OV5640_WRITE_REG_DATA8, 0x3c05, 0x98},
    {OV5640_WRITE_REG_DATA8, 0x3c06, 0x00},
    {OV5640_WRITE_REG_DATA8, 0x3c07, 0x07},
    {OV5640_WRITE_REG_DATA8, 0x3c08, 0x00},
    {OV5640_WRITE_REG_DATA8, 0x3c09, 0x1c},
    {OV5640_WRITE_REG_DATA8, 0x3c0a, 0x9c},
    {OV5640_WRITE_REG_DATA8, 0x3c0b, 0x40},
    {OV5640_WRITE_REG_DATA8, 0x3820, 0x41},
    {OV5640_WRITE_REG_DATA8, 0x3821, 0x07},
    {OV5640_WRITE_REG_DATA8, 0x3814, 0x31},
    {OV5640_WRITE_REG_DATA8, 0x3815, 0x31},
    {OV5640_WRITE_REG_DATA8, 0x3800, 0x00},
    {OV5640_WRITE_REG_DATA8, 0x3801, 0x00},
    {OV5640_WRITE_REG_DATA8, 0x3802, 0x00},
    {OV5640_WRITE_REG_DATA8, 0x3803, 0x00},
    {OV5640_WRITE_REG_DATA8, 0x3804, 0x0a},
    {OV5640_WRITE_REG_DATA8, 0x3805, 0x3f},
    {OV5640_WRITE_REG_DATA8, 0x3806, 0x07},
    {OV5640_WRITE_REG_DATA8, 0x3807, 0x9f},
    {OV5640_WRITE_REG_DATA8, 0x3808, 0x05},
    {OV5640_WRITE_REG_DATA8, 0x3809, 0x18},
    {OV5640_WRITE_REG_DATA8, 0x380a, 0x03},
    {OV5640_WRITE_REG_DATA8, 0x380b, 0xcc},
    {OV5640_WRITE_REG_DATA8, 0x380c, 0x07},
    {OV5640_WRITE_REG_DATA8, 0x380d, 0x5e},
    {OV5640_WRITE_REG_DATA8, 0x380e, 0x03},
    {OV5640_WRITE_REG_DATA8, 0x380f, 0xde},
    {OV5640_WRITE_REG_DATA8, 0x3810, 0x00},
    {OV5640_WRITE_REG_DATA8, 0x3811, 0x06},
    {OV5640_WRITE_REG_DATA8, 0x3812, 0x00},
    {OV5640_WRITE_REG_DATA8, 0x3813, 0x02},
    {OV5640_WRITE_REG_DATA8, 0x3618, 0x00},
    {OV5640_WRITE_REG_DATA8, 0x3612, 0x29},
    {OV5640_WRITE_REG_DATA8, 0x3708, 0x62},
    {OV5640_WRITE_REG_DATA8, 0x3709, 0x52},
    {OV5640_WRITE_REG_DATA8, 0x370c, 0x03},
    {OV5640_WRITE_REG_DATA8, 0x3a02, 0x03},
    {OV5640_WRITE_REG_DATA8, 0x3a03, 0xd8},
    {OV5640_WRITE_REG_DATA8, 0x3a08, 0x01},
    {OV5640_WRITE_REG_DATA8, 0x3a09, 0x27},
    {OV5640_WRITE_REG_DATA8, 0x3a0a, 0x00},
    {OV5640_WRITE_REG_DATA8, 0x3a0b, 0xf6},
    {OV5640_WRITE_REG_DATA8, 0x3a0e, 0x03},
    {OV5640_WRITE_REG_DATA8, 0x3a0d, 0x04},
    {OV5640_WRITE_REG_DATA8, 0x3a14, 0x03},
    {OV5640_WRITE_REG_DATA8, 0x3a15, 0xd8},
    {OV5640_WRITE_REG_DATA8, 0x4001, 0x02},
    {OV5640_WRITE_REG_DATA8, 0x4004, 0x02},
    {OV5640_WRITE_REG_DATA8, 0x3000, 0x00},
    {OV5640_WRITE_REG_DATA8, 0x3002, 0x1c},
    {OV5640_WRITE_REG_DATA8, 0x3004, 0xff},
    {OV5640_WRITE_REG_DATA8, 0x3006, 0xc3},
    {OV5640_WRITE_REG_DATA8, 0x300e, 0x45},
    {OV5640_WRITE_REG_DATA8, 0x302e, 0x08},
    {OV5640_WRITE_REG_DATA8, 0x4300, 0x32},
    {OV5640_WRITE_REG_DATA8, 0x501f, 0x00},
    {OV5640_WRITE_REG_DATA8, 0x4713, 0x02},
    {OV5640_WRITE_REG_DATA8, 0x4407, 0x04},
    {OV5640_WRITE_REG_DATA8, 0x440e, 0x00},
    {OV5640_WRITE_REG_DATA8, 0x460b, 0x37},
    {OV5640_WRITE_REG_DATA8, 0x460c, 0x20},
    //{OV5640_WRITE_REG_DATA8, 0x4800, 0x24},
    {OV5640_WRITE_REG_DATA8, 0x4837, 0x10},
    {OV5640_WRITE_REG_DATA8, 0x3824, 0x04},
    {OV5640_WRITE_REG_DATA8, 0x5000, 0xa7},
    {OV5640_WRITE_REG_DATA8, 0x5001, 0x83},
    {OV5640_WRITE_REG_DATA8, 0x5180, 0xff},
    {OV5640_WRITE_REG_DATA8, 0x5181, 0xf2},
    {OV5640_WRITE_REG_DATA8, 0x5182, 0x00},
    {OV5640_WRITE_REG_DATA8, 0x5183, 0x14},
    {OV5640_WRITE_REG_DATA8, 0x5184, 0x25},
    {OV5640_WRITE_REG_DATA8, 0x5185, 0x24},
    {OV5640_WRITE_REG_DATA8, 0x5186, 0x09},
    {OV5640_WRITE_REG_DATA8, 0x5187, 0x09},
    {OV5640_WRITE_REG_DATA8, 0x5188, 0x09},
    {OV5640_WRITE_REG_DATA8, 0x5189, 0x75},
    {OV5640_WRITE_REG_DATA8, 0x518a, 0x54},
    {OV5640_WRITE_REG_DATA8, 0x518b, 0xe0},
    {OV5640_WRITE_REG_DATA8, 0x518c, 0xb2},
    {OV5640_WRITE_REG_DATA8, 0x518d, 0x42},
    {OV5640_WRITE_REG_DATA8, 0x518e, 0x3d},
    {OV5640_WRITE_REG_DATA8, 0x518f, 0x56},
    {OV5640_WRITE_REG_DATA8, 0x5190, 0x46},
    {OV5640_WRITE_REG_DATA8, 0x5191, 0xf8},
    {OV5640_WRITE_REG_DATA8, 0x5192, 0x04},
    {OV5640_WRITE_REG_DATA8, 0x5193, 0x70},
    {OV5640_WRITE_REG_DATA8, 0x5194, 0xf0},
    {OV5640_WRITE_REG_DATA8, 0x5195, 0xf0},
    {OV5640_WRITE_REG_DATA8, 0x5196, 0x03},
    {OV5640_WRITE_REG_DATA8, 0x5197, 0x01},
    {OV5640_WRITE_REG_DATA8, 0x5198, 0x04},
    {OV5640_WRITE_REG_DATA8, 0x5199, 0x12},
    {OV5640_WRITE_REG_DATA8, 0x519a, 0x04},
    {OV5640_WRITE_REG_DATA8, 0x519b, 0x00},
    {OV5640_WRITE_REG_DATA8, 0x519c, 0x06},
    {OV5640_WRITE_REG_DATA8, 0x519d, 0x82},
    {OV5640_WRITE_REG_DATA8, 0x519e, 0x38},
    {OV5640_WRITE_REG_DATA8, 0x5381, 0x1e},
    {OV5640_WRITE_REG_DATA8, 0x5382, 0x5b},
    {OV5640_WRITE_REG_DATA8, 0x5383, 0x08},
    {OV5640_WRITE_REG_DATA8, 0x5384, 0x0a},
    {OV5640_WRITE_REG_DATA8, 0x5385, 0x7e},
    {OV5640_WRITE_REG_DATA8, 0x5386, 0x88},
    {OV5640_WRITE_REG_DATA8, 0x5387, 0x7c},
    {OV5640_WRITE_REG_DATA8, 0x5388, 0x6c},
    {OV5640_WRITE_REG_DATA8, 0x5389, 0x10},
    {OV5640_WRITE_REG_DATA8, 0x538a, 0x01},
    {OV5640_WRITE_REG_DATA8, 0x538b, 0x98},
    {OV5640_WRITE_REG_DATA8, 0x5300, 0x08},
    {OV5640_WRITE_REG_DATA8, 0x5301, 0x30},
    {OV5640_WRITE_REG_DATA8, 0x5302, 0x10},
    {OV5640_WRITE_REG_DATA8, 0x5303, 0x00},
    {OV5640_WRITE_REG_DATA8, 0x5304, 0x08},
    {OV5640_WRITE_REG_DATA8, 0x5305, 0x30},
    {OV5640_WRITE_REG_DATA8, 0x5306, 0x08},
    {OV5640_WRITE_REG_DATA8, 0x5307, 0x16},
    {OV5640_WRITE_REG_DATA8, 0x5309, 0x08},
    {OV5640_WRITE_REG_DATA8, 0x530a, 0x30},
    {OV5640_WRITE_REG_DATA8, 0x530b, 0x04},
    {OV5640_WRITE_REG_DATA8, 0x530c, 0x06},
    {OV5640_WRITE_REG_DATA8, 0x5480, 0x01},
    {OV5640_WRITE_REG_DATA8, 0x5481, 0x08},
    {OV5640_WRITE_REG_DATA8, 0x5482, 0x14},
    {OV5640_WRITE_REG_DATA8, 0x5483, 0x28},
    {OV5640_WRITE_REG_DATA8, 0x5484, 0x51},
    {OV5640_WRITE_REG_DATA8, 0x5485, 0x65},
    {OV5640_WRITE_REG_DATA8, 0x5486, 0x71},
    {OV5640_WRITE_REG_DATA8, 0x5487, 0x7d},
    {OV5640_WRITE_REG_DATA8, 0x5488, 0x87},
    {OV5640_WRITE_REG_DATA8, 0x5489, 0x91},
    {OV5640_WRITE_REG_DATA8, 0x548a, 0x9a},
    {OV5640_WRITE_REG_DATA8, 0x548b, 0xaa},
    {OV5640_WRITE_REG_DATA8, 0x548c, 0xb8},
    {OV5640_WRITE_REG_DATA8, 0x548d, 0xcd},
    {OV5640_WRITE_REG_DATA8, 0x548e, 0xdd},
    {OV5640_WRITE_REG_DATA8, 0x548f, 0xea},
    {OV5640_WRITE_REG_DATA8, 0x5490, 0x1d},
    {OV5640_WRITE_REG_DATA8, 0x5580, 0x02},
    {OV5640_WRITE_REG_DATA8, 0x5583, 0x40},
    {OV5640_WRITE_REG_DATA8, 0x5584, 0x10},
    {OV5640_WRITE_REG_DATA8, 0x5589, 0x10},
    {OV5640_WRITE_REG_DATA8, 0x558a, 0x00},
    {OV5640_WRITE_REG_DATA8, 0x558b, 0xf8},
    {OV5640_WRITE_REG_DATA8, 0x5800, 0x23},
    {OV5640_WRITE_REG_DATA8, 0x5801, 0x14},
    {OV5640_WRITE_REG_DATA8, 0x5802, 0x0f},
    {OV5640_WRITE_REG_DATA8, 0x5803, 0x0f},
    {OV5640_WRITE_REG_DATA8, 0x5804, 0x12},
    {OV5640_WRITE_REG_DATA8, 0x5805, 0x26},
    {OV5640_WRITE_REG_DATA8, 0x5806, 0x0c},
    {OV5640_WRITE_REG_DATA8, 0x5807, 0x08},
    {OV5640_WRITE_REG_DATA8, 0x5808, 0x05},
    {OV5640_WRITE_REG_DATA8, 0x5809, 0x05},
    {OV5640_WRITE_REG_DATA8, 0x580a, 0x08},
    {OV5640_WRITE_REG_DATA8, 0x580b, 0x0d},
    {OV5640_WRITE_REG_DATA8, 0x580c, 0x08},
    {OV5640_WRITE_REG_DATA8, 0x580d, 0x03},
    {OV5640_WRITE_REG_DATA8, 0x580e, 0x00},
    {OV5640_WRITE_REG_DATA8, 0x580f, 0x00},
    {OV5640_WRITE_REG_DATA8, 0x5810, 0x03},
    {OV5640_WRITE_REG_DATA8, 0x5811, 0x09},
    {OV5640_WRITE_REG_DATA8, 0x5812, 0x07},
    {OV5640_WRITE_REG_DATA8, 0x5813, 0x03},
    {OV5640_WRITE_REG_DATA8, 0x5814, 0x00},
    {OV5640_WRITE_REG_DATA8, 0x5815, 0x01},
    {OV5640_WRITE_REG_DATA8, 0x5816, 0x03},
    {OV5640_WRITE_REG_DATA8, 0x5817, 0x08},
    {OV5640_WRITE_REG_DATA8, 0x5818, 0x0d},
    {OV5640_WRITE_REG_DATA8, 0x5819, 0x08},
    {OV5640_WRITE_REG_DATA8, 0x581a, 0x05},
    {OV5640_WRITE_REG_DATA8, 0x581b, 0x06},
    {OV5640_WRITE_REG_DATA8, 0x581c, 0x08},
    {OV5640_WRITE_REG_DATA8, 0x581d, 0x0e},
    {OV5640_WRITE_REG_DATA8, 0x581e, 0x29},
    {OV5640_WRITE_REG_DATA8, 0x581f, 0x17},
    {OV5640_WRITE_REG_DATA8, 0x5820, 0x11},
    {OV5640_WRITE_REG_DATA8, 0x5821, 0x11},
    {OV5640_WRITE_REG_DATA8, 0x5822, 0x15},
    {OV5640_WRITE_REG_DATA8, 0x5823, 0x28},
    {OV5640_WRITE_REG_DATA8, 0x5824, 0x46},
    {OV5640_WRITE_REG_DATA8, 0x5825, 0x26},
    {OV5640_WRITE_REG_DATA8, 0x5826, 0x08},
    {OV5640_WRITE_REG_DATA8, 0x5827, 0x26},
    {OV5640_WRITE_REG_DATA8, 0x5828, 0x64},
    {OV5640_WRITE_REG_DATA8, 0x5829, 0x26},
    {OV5640_WRITE_REG_DATA8, 0x582a, 0x24},
    {OV5640_WRITE_REG_DATA8, 0x582b, 0x22},
    {OV5640_WRITE_REG_DATA8, 0x582c, 0x24},
    {OV5640_WRITE_REG_DATA8, 0x582d, 0x24},
    {OV5640_WRITE_REG_DATA8, 0x582e, 0x06},
    {OV5640_WRITE_REG_DATA8, 0x582f, 0x22},
    {OV5640_WRITE_REG_DATA8, 0x5830, 0x40},
    {OV5640_WRITE_REG_DATA8, 0x5831, 0x42},
    {OV5640_WRITE_REG_DATA8, 0x5832, 0x24},
    {OV5640_WRITE_REG_DATA8, 0x5833, 0x26},
    {OV5640_WRITE_REG_DATA8, 0x5834, 0x24},
    {OV5640_WRITE_REG_DATA8, 0x5835, 0x22},
    {OV5640_WRITE_REG_DATA8, 0x5836, 0x22},
    {OV5640_WRITE_REG_DATA8, 0x5837, 0x26},
    {OV5640_WRITE_REG_DATA8, 0x5838, 0x44},
    {OV5640_WRITE_REG_DATA8, 0x5839, 0x24},
    {OV5640_WRITE_REG_DATA8, 0x583a, 0x26},
    {OV5640_WRITE_REG_DATA8, 0x583b, 0x28},
    {OV5640_WRITE_REG_DATA8, 0x583c, 0x42},
    {OV5640_WRITE_REG_DATA8, 0x583d, 0xce},
    {OV5640_WRITE_REG_DATA8, 0x5025, 0x00},
    {OV5640_WRITE_REG_DATA8, 0x3a0f, 0x30},
    {OV5640_WRITE_REG_DATA8, 0x3a10, 0x28},
    {OV5640_WRITE_REG_DATA8, 0x3a1b, 0x30},
    {OV5640_WRITE_REG_DATA8, 0x3a1e, 0x26},
    {OV5640_WRITE_REG_DATA8, 0x3a11, 0x60},
    {OV5640_WRITE_REG_DATA8, 0x3a1f, 0x14},
    {OV5640_WRITE_REG_DATA8, 0x3008, 0x02},

    //{OV5640_WRITE_REG_DATA8, 0x4201, 0x00}, // start after 1 frame
    //{OV5640_WRITE_REG_DATA8, 0x4202, 0x01},
    {OV5640_WAIT_MS, 0x0000, 100},
    {OV5640_TABLE_END, 0x0000, 0x00}
};

static struct ov5640_reg mode_1920x1080[] = {
/* PLL Control MIPI bit rate/lane = 672MHz, 16-bit mode.
 * Output size: 1936x1096 (336, 426) - (2287, 1529),
 * Line Length = 2500, Frame Length = 1120.
 */
    {OV5640_WRITE_REG_DATA8, 0x3103, 0x11},
    //{OV5640_WRITE_REG_DATA8, 0x3008, 0x82},
    {OV5640_WAIT_MS, 0x0000, 5},
    {OV5640_WRITE_REG_DATA8, 0x3008, 0x42},
    {OV5640_WRITE_REG_DATA8, 0x3103, 0x03},
    {OV5640_WRITE_REG_DATA8, 0x3017, 0x00},
    {OV5640_WRITE_REG_DATA8, 0x3018, 0x00},
    {OV5640_WRITE_REG_DATA8, 0x3034, 0x18},
    {OV5640_WRITE_REG_DATA8, 0x3035, 0x11},
    {OV5640_WRITE_REG_DATA8, 0x3036, 0x54},
    {OV5640_WRITE_REG_DATA8, 0x3037, 0x13},
    {OV5640_WRITE_REG_DATA8, 0x3108, 0x01},
    {OV5640_WRITE_REG_DATA8, 0x3630, 0x36},
    {OV5640_WRITE_REG_DATA8, 0x3631, 0x0e},
    {OV5640_WRITE_REG_DATA8, 0x3632, 0xe2},
    {OV5640_WRITE_REG_DATA8, 0x3633, 0x12},
    {OV5640_WRITE_REG_DATA8, 0x3621, 0xe0},
    {OV5640_WRITE_REG_DATA8, 0x3704, 0xa0},
    {OV5640_WRITE_REG_DATA8, 0x3703, 0x5a},
    {OV5640_WRITE_REG_DATA8, 0x3715, 0x78},
    {OV5640_WRITE_REG_DATA8, 0x3717, 0x01},
    {OV5640_WRITE_REG_DATA8, 0x370b, 0x60},
    {OV5640_WRITE_REG_DATA8, 0x3705, 0x1a},
    {OV5640_WRITE_REG_DATA8, 0x3905, 0x02},
    {OV5640_WRITE_REG_DATA8, 0x3906, 0x10},
    {OV5640_WRITE_REG_DATA8, 0x3901, 0x0a},
    {OV5640_WRITE_REG_DATA8, 0x3731, 0x12},
    {OV5640_WRITE_REG_DATA8, 0x3600, 0x08},
    {OV5640_WRITE_REG_DATA8, 0x3601, 0x33},
    {OV5640_WRITE_REG_DATA8, 0x302d, 0x60},
    {OV5640_WRITE_REG_DATA8, 0x3620, 0x52},
    {OV5640_WRITE_REG_DATA8, 0x371b, 0x20},
    {OV5640_WRITE_REG_DATA8, 0x471c, 0x50},
    {OV5640_WRITE_REG_DATA8, 0x3a13, 0x43},
    {OV5640_WRITE_REG_DATA8, 0x3a18, 0x00},
    {OV5640_WRITE_REG_DATA8, 0x3a19, 0xf8},
    {OV5640_WRITE_REG_DATA8, 0x3635, 0x13},
    {OV5640_WRITE_REG_DATA8, 0x3636, 0x03},
    {OV5640_WRITE_REG_DATA8, 0x3634, 0x40},
    {OV5640_WRITE_REG_DATA8, 0x3622, 0x01},
    {OV5640_WRITE_REG_DATA8, 0x3c01, 0x34},
    {OV5640_WRITE_REG_DATA8, 0x3c04, 0x28},
    {OV5640_WRITE_REG_DATA8, 0x3c05, 0x98},
    {OV5640_WRITE_REG_DATA8, 0x3c06, 0x00},
    {OV5640_WRITE_REG_DATA8, 0x3c07, 0x07},
    {OV5640_WRITE_REG_DATA8, 0x3c08, 0x00},
    {OV5640_WRITE_REG_DATA8, 0x3c09, 0x1c},
    {OV5640_WRITE_REG_DATA8, 0x3c0a, 0x9c},
    {OV5640_WRITE_REG_DATA8, 0x3c0b, 0x40},
    {OV5640_WRITE_REG_DATA8, 0x3820, 0x41},
    {OV5640_WRITE_REG_DATA8, 0x3821, 0x07},
    {OV5640_WRITE_REG_DATA8, 0x3814, 0x11},
    {OV5640_WRITE_REG_DATA8, 0x3815, 0x11},
    {OV5640_WRITE_REG_DATA8, 0x3800, 0x01},
    {OV5640_WRITE_REG_DATA8, 0x3801, 0x50},
    {OV5640_WRITE_REG_DATA8, 0x3802, 0x01},
    {OV5640_WRITE_REG_DATA8, 0x3803, 0xaa},
    {OV5640_WRITE_REG_DATA8, 0x3804, 0x08},
    {OV5640_WRITE_REG_DATA8, 0x3805, 0xef},
    {OV5640_WRITE_REG_DATA8, 0x3806, 0x05},
    {OV5640_WRITE_REG_DATA8, 0x3807, 0xf9},
    {OV5640_WRITE_REG_DATA8, 0x3808, 0x07},
    {OV5640_WRITE_REG_DATA8, 0x3809, 0x90},
    {OV5640_WRITE_REG_DATA8, 0x380a, 0x04},
    {OV5640_WRITE_REG_DATA8, 0x380b, 0x48},
    {OV5640_WRITE_REG_DATA8, 0x380c, 0x09},
    {OV5640_WRITE_REG_DATA8, 0x380d, 0xc4},
    {OV5640_WRITE_REG_DATA8, 0x380e, 0x04},
    {OV5640_WRITE_REG_DATA8, 0x380f, 0x60},
    {OV5640_WRITE_REG_DATA8, 0x3810, 0x00},
    {OV5640_WRITE_REG_DATA8, 0x3811, 0x08},
    {OV5640_WRITE_REG_DATA8, 0x3812, 0x00},
    {OV5640_WRITE_REG_DATA8, 0x3813, 0x04},
    {OV5640_WRITE_REG_DATA8, 0x3618, 0x04},
    {OV5640_WRITE_REG_DATA8, 0x3612, 0x2b},
    {OV5640_WRITE_REG_DATA8, 0x3708, 0x64},
    {OV5640_WRITE_REG_DATA8, 0x3709, 0x12},
    {OV5640_WRITE_REG_DATA8, 0x370c, 0x00},
    {OV5640_WRITE_REG_DATA8, 0x3a02, 0x04},
    {OV5640_WRITE_REG_DATA8, 0x3a03, 0x60},
    {OV5640_WRITE_REG_DATA8, 0x3a08, 0x01},
    {OV5640_WRITE_REG_DATA8, 0x3a09, 0x50},
    {OV5640_WRITE_REG_DATA8, 0x3a0a, 0x01},
    {OV5640_WRITE_REG_DATA8, 0x3a0b, 0x18},
    {OV5640_WRITE_REG_DATA8, 0x3a0e, 0x03},
    {OV5640_WRITE_REG_DATA8, 0x3a0d, 0x04},
    {OV5640_WRITE_REG_DATA8, 0x3a14, 0x04},
    {OV5640_WRITE_REG_DATA8, 0x3a15, 0x60},
    {OV5640_WRITE_REG_DATA8, 0x4001, 0x02},
    {OV5640_WRITE_REG_DATA8, 0x4004, 0x06},
    {OV5640_WRITE_REG_DATA8, 0x3000, 0x00},
    {OV5640_WRITE_REG_DATA8, 0x3002, 0x1c},
    {OV5640_WRITE_REG_DATA8, 0x3004, 0xff},
    {OV5640_WRITE_REG_DATA8, 0x3006, 0xc3},
    {OV5640_WRITE_REG_DATA8, 0x300e, 0x45},
    {OV5640_WRITE_REG_DATA8, 0x302e, 0x08},
    {OV5640_WRITE_REG_DATA8, 0x4300, 0x32},
    {OV5640_WRITE_REG_DATA8, 0x501f, 0x00},
    {OV5640_WRITE_REG_DATA8, 0x4713, 0x02},
    {OV5640_WRITE_REG_DATA8, 0x4407, 0x04},
    {OV5640_WRITE_REG_DATA8, 0x440e, 0x00},
    {OV5640_WRITE_REG_DATA8, 0x460b, 0x37},
    {OV5640_WRITE_REG_DATA8, 0x460c, 0x20},
    //{OV5640_WRITE_REG_DATA8, 0x4800, 0x24},
    {OV5640_WRITE_REG_DATA8, 0x4837, 0x0a},
    {OV5640_WRITE_REG_DATA8, 0x3824, 0x04},
    {OV5640_WRITE_REG_DATA8, 0x5000, 0xa7},
    {OV5640_WRITE_REG_DATA8, 0x5001, 0x83},
    {OV5640_WRITE_REG_DATA8, 0x5180, 0xff},
    {OV5640_WRITE_REG_DATA8, 0x5181, 0xf2},
    {OV5640_WRITE_REG_DATA8, 0x5182, 0x00},
    {OV5640_WRITE_REG_DATA8, 0x5183, 0x14},
    {OV5640_WRITE_REG_DATA8, 0x5184, 0x25},
    {OV5640_WRITE_REG_DATA8, 0x5185, 0x24},
    {OV5640_WRITE_REG_DATA8, 0x5186, 0x09},
    {OV5640_WRITE_REG_DATA8, 0x5187, 0x09},
    {OV5640_WRITE_REG_DATA8, 0x5188, 0x09},
    {OV5640_WRITE_REG_DATA8, 0x5189, 0x75},
    {OV5640_WRITE_REG_DATA8, 0x518a, 0x54},
    {OV5640_WRITE_REG_DATA8, 0x518b, 0xe0},
    {OV5640_WRITE_REG_DATA8, 0x518c, 0xb2},
    {OV5640_WRITE_REG_DATA8, 0x518d, 0x42},
    {OV5640_WRITE_REG_DATA8, 0x518e, 0x3d},
    {OV5640_WRITE_REG_DATA8, 0x518f, 0x56},
    {OV5640_WRITE_REG_DATA8, 0x5190, 0x46},
    {OV5640_WRITE_REG_DATA8, 0x5191, 0xf8},
    {OV5640_WRITE_REG_DATA8, 0x5192, 0x04},
    {OV5640_WRITE_REG_DATA8, 0x5193, 0x70},
    {OV5640_WRITE_REG_DATA8, 0x5194, 0xf0},
    {OV5640_WRITE_REG_DATA8, 0x5195, 0xf0},
    {OV5640_WRITE_REG_DATA8, 0x5196, 0x03},
    {OV5640_WRITE_REG_DATA8, 0x5197, 0x01},
    {OV5640_WRITE_REG_DATA8, 0x5198, 0x04},
    {OV5640_WRITE_REG_DATA8, 0x5199, 0x12},
    {OV5640_WRITE_REG_DATA8, 0x519a, 0x04},
    {OV5640_WRITE_REG_DATA8, 0x519b, 0x00},
    {OV5640_WRITE_REG_DATA8, 0x519c, 0x06},
    {OV5640_WRITE_REG_DATA8, 0x519d, 0x82},
    {OV5640_WRITE_REG_DATA8, 0x519e, 0x38},
    {OV5640_WRITE_REG_DATA8, 0x5381, 0x1e},
    {OV5640_WRITE_REG_DATA8, 0x5382, 0x5b},
    {OV5640_WRITE_REG_DATA8, 0x5383, 0x08},
    {OV5640_WRITE_REG_DATA8, 0x5384, 0x0a},
    {OV5640_WRITE_REG_DATA8, 0x5385, 0x7e},
    {OV5640_WRITE_REG_DATA8, 0x5386, 0x88},
    {OV5640_WRITE_REG_DATA8, 0x5387, 0x7c},
    {OV5640_WRITE_REG_DATA8, 0x5388, 0x6c},
    {OV5640_WRITE_REG_DATA8, 0x5389, 0x10},
    {OV5640_WRITE_REG_DATA8, 0x538a, 0x01},
    {OV5640_WRITE_REG_DATA8, 0x538b, 0x98},
    {OV5640_WRITE_REG_DATA8, 0x5300, 0x08},
    {OV5640_WRITE_REG_DATA8, 0x5301, 0x30},
    {OV5640_WRITE_REG_DATA8, 0x5302, 0x10},
    {OV5640_WRITE_REG_DATA8, 0x5303, 0x00},
    {OV5640_WRITE_REG_DATA8, 0x5304, 0x08},
    {OV5640_WRITE_REG_DATA8, 0x5305, 0x30},
    {OV5640_WRITE_REG_DATA8, 0x5306, 0x08},
    {OV5640_WRITE_REG_DATA8, 0x5307, 0x16},
    {OV5640_WRITE_REG_DATA8, 0x5309, 0x08},
    {OV5640_WRITE_REG_DATA8, 0x530a, 0x30},
    {OV5640_WRITE_REG_DATA8, 0x530b, 0x04},
    {OV5640_WRITE_REG_DATA8, 0x530c, 0x06},
    {OV5640_WRITE_REG_DATA8, 0x5480, 0x01},
    {OV5640_WRITE_REG_DATA8, 0x5481, 0x08},
    {OV5640_WRITE_REG_DATA8, 0x5482, 0x14},
    {OV5640_WRITE_REG_DATA8, 0x5483, 0x28},
    {OV5640_WRITE_REG_DATA8, 0x5484, 0x51},
    {OV5640_WRITE_REG_DATA8, 0x5485, 0x65},
    {OV5640_WRITE_REG_DATA8, 0x5486, 0x71},
    {OV5640_WRITE_REG_DATA8, 0x5487, 0x7d},
    {OV5640_WRITE_REG_DATA8, 0x5488, 0x87},
    {OV5640_WRITE_REG_DATA8, 0x5489, 0x91},
    {OV5640_WRITE_REG_DATA8, 0x548a, 0x9a},
    {OV5640_WRITE_REG_DATA8, 0x548b, 0xaa},
    {OV5640_WRITE_REG_DATA8, 0x548c, 0xb8},
    {OV5640_WRITE_REG_DATA8, 0x548d, 0xcd},
    {OV5640_WRITE_REG_DATA8, 0x548e, 0xdd},
    {OV5640_WRITE_REG_DATA8, 0x548f, 0xea},
    {OV5640_WRITE_REG_DATA8, 0x5490, 0x1d},
    {OV5640_WRITE_REG_DATA8, 0x5580, 0x02},
    {OV5640_WRITE_REG_DATA8, 0x5583, 0x40},
    {OV5640_WRITE_REG_DATA8, 0x5584, 0x10},
    {OV5640_WRITE_REG_DATA8, 0x5589, 0x10},
    {OV5640_WRITE_REG_DATA8, 0x558a, 0x00},
    {OV5640_WRITE_REG_DATA8, 0x558b, 0xf8},
    {OV5640_WRITE_REG_DATA8, 0x5800, 0x23},
    {OV5640_WRITE_REG_DATA8, 0x5801, 0x14},
    {OV5640_WRITE_REG_DATA8, 0x5802, 0x0f},
    {OV5640_WRITE_REG_DATA8, 0x5803, 0x0f},
    {OV5640_WRITE_REG_DATA8, 0x5804, 0x12},
    {OV5640_WRITE_REG_DATA8, 0x5805, 0x26},
    {OV5640_WRITE_REG_DATA8, 0x5806, 0x0c},
    {OV5640_WRITE_REG_DATA8, 0x5807, 0x08},
    {OV5640_WRITE_REG_DATA8, 0x5808, 0x05},
    {OV5640_WRITE_REG_DATA8, 0x5809, 0x05},
    {OV5640_WRITE_REG_DATA8, 0x580a, 0x08},
    {OV5640_WRITE_REG_DATA8, 0x580b, 0x0d},
    {OV5640_WRITE_REG_DATA8, 0x580c, 0x08},
    {OV5640_WRITE_REG_DATA8, 0x580d, 0x03},
    {OV5640_WRITE_REG_DATA8, 0x580e, 0x00},
    {OV5640_WRITE_REG_DATA8, 0x580f, 0x00},
    {OV5640_WRITE_REG_DATA8, 0x5810, 0x03},
    {OV5640_WRITE_REG_DATA8, 0x5811, 0x09},
    {OV5640_WRITE_REG_DATA8, 0x5812, 0x07},
    {OV5640_WRITE_REG_DATA8, 0x5813, 0x03},
    {OV5640_WRITE_REG_DATA8, 0x5814, 0x00},
    {OV5640_WRITE_REG_DATA8, 0x5815, 0x01},
    {OV5640_WRITE_REG_DATA8, 0x5816, 0x03},
    {OV5640_WRITE_REG_DATA8, 0x5817, 0x08},
    {OV5640_WRITE_REG_DATA8, 0x5818, 0x0d},
    {OV5640_WRITE_REG_DATA8, 0x5819, 0x08},
    {OV5640_WRITE_REG_DATA8, 0x581a, 0x05},
    {OV5640_WRITE_REG_DATA8, 0x581b, 0x06},
    {OV5640_WRITE_REG_DATA8, 0x581c, 0x08},
    {OV5640_WRITE_REG_DATA8, 0x581d, 0x0e},
    {OV5640_WRITE_REG_DATA8, 0x581e, 0x29},
    {OV5640_WRITE_REG_DATA8, 0x581f, 0x17},
    {OV5640_WRITE_REG_DATA8, 0x5820, 0x11},
    {OV5640_WRITE_REG_DATA8, 0x5821, 0x11},
    {OV5640_WRITE_REG_DATA8, 0x5822, 0x15},
    {OV5640_WRITE_REG_DATA8, 0x5823, 0x28},
    {OV5640_WRITE_REG_DATA8, 0x5824, 0x46},
    {OV5640_WRITE_REG_DATA8, 0x5825, 0x26},
    {OV5640_WRITE_REG_DATA8, 0x5826, 0x08},
    {OV5640_WRITE_REG_DATA8, 0x5827, 0x26},
    {OV5640_WRITE_REG_DATA8, 0x5828, 0x64},
    {OV5640_WRITE_REG_DATA8, 0x5829, 0x26},
    {OV5640_WRITE_REG_DATA8, 0x582a, 0x24},
    {OV5640_WRITE_REG_DATA8, 0x582b, 0x22},
    {OV5640_WRITE_REG_DATA8, 0x582c, 0x24},
    {OV5640_WRITE_REG_DATA8, 0x582d, 0x24},
    {OV5640_WRITE_REG_DATA8, 0x582e, 0x06},
    {OV5640_WRITE_REG_DATA8, 0x582f, 0x22},
    {OV5640_WRITE_REG_DATA8, 0x5830, 0x40},
    {OV5640_WRITE_REG_DATA8, 0x5831, 0x42},
    {OV5640_WRITE_REG_DATA8, 0x5832, 0x24},
    {OV5640_WRITE_REG_DATA8, 0x5833, 0x26},
    {OV5640_WRITE_REG_DATA8, 0x5834, 0x24},
    {OV5640_WRITE_REG_DATA8, 0x5835, 0x22},
    {OV5640_WRITE_REG_DATA8, 0x5836, 0x22},
    {OV5640_WRITE_REG_DATA8, 0x5837, 0x26},
    {OV5640_WRITE_REG_DATA8, 0x5838, 0x44},
    {OV5640_WRITE_REG_DATA8, 0x5839, 0x24},
    {OV5640_WRITE_REG_DATA8, 0x583a, 0x26},
    {OV5640_WRITE_REG_DATA8, 0x583b, 0x28},
    {OV5640_WRITE_REG_DATA8, 0x583c, 0x42},
    {OV5640_WRITE_REG_DATA8, 0x583d, 0xce},
    {OV5640_WRITE_REG_DATA8, 0x5025, 0x00},
    {OV5640_WRITE_REG_DATA8, 0x3a0f, 0x30},
    {OV5640_WRITE_REG_DATA8, 0x3a10, 0x28},
    {OV5640_WRITE_REG_DATA8, 0x3a1b, 0x30},
    {OV5640_WRITE_REG_DATA8, 0x3a1e, 0x26},
    {OV5640_WRITE_REG_DATA8, 0x3a11, 0x60},
    {OV5640_WRITE_REG_DATA8, 0x3a1f, 0x14},
    {OV5640_WRITE_REG_DATA8, 0x3008, 0x02},

    //{OV5640_WRITE_REG_DATA8, 0x4201, 0x00}, //start after 1 frame
    //{OV5640_WRITE_REG_DATA8, 0x4202, 0x01},
    {OV5640_WAIT_MS, 0x0000, 100},
    {OV5640_TABLE_END, 0x0000, 0x00}
};

static struct ov5640_reg mode_2592x1944[] = {
/* PLL Control MIPI bit rate/lane = 672MHz, 16-bit mode.
 * Output size: 2608x1948 (0, 0) - (2623, 1951),
 * Line Length = 2844, Frame Length = 1968
 */
    {OV5640_WRITE_REG_DATA8, 0x3103, 0x11},
    //{OV5640_WRITE_REG_DATA8, 0x3008, 0x82},
    {OV5640_WAIT_MS, 0x0000, 5},
    {OV5640_WRITE_REG_DATA8, 0x3008, 0x42},
    {OV5640_WRITE_REG_DATA8, 0x3103, 0x03},
    {OV5640_WRITE_REG_DATA8, 0x3017, 0x00},
    {OV5640_WRITE_REG_DATA8, 0x3018, 0x00},
    {OV5640_WRITE_REG_DATA8, 0x3034, 0x18},
    {OV5640_WRITE_REG_DATA8, 0x3035, 0x11},
    {OV5640_WRITE_REG_DATA8, 0x3036, 0x54},
    {OV5640_WRITE_REG_DATA8, 0x3037, 0x13},
    {OV5640_WRITE_REG_DATA8, 0x3108, 0x01},
    {OV5640_WRITE_REG_DATA8, 0x3630, 0x36},
    {OV5640_WRITE_REG_DATA8, 0x3631, 0x0e},
    {OV5640_WRITE_REG_DATA8, 0x3632, 0xe2},
    {OV5640_WRITE_REG_DATA8, 0x3633, 0x12},
    {OV5640_WRITE_REG_DATA8, 0x3621, 0xe0},
    {OV5640_WRITE_REG_DATA8, 0x3704, 0xa0},
    {OV5640_WRITE_REG_DATA8, 0x3703, 0x5a},
    {OV5640_WRITE_REG_DATA8, 0x3715, 0x78},
    {OV5640_WRITE_REG_DATA8, 0x3717, 0x01},
    {OV5640_WRITE_REG_DATA8, 0x370b, 0x60},
    {OV5640_WRITE_REG_DATA8, 0x3705, 0x1a},
    {OV5640_WRITE_REG_DATA8, 0x3905, 0x02},
    {OV5640_WRITE_REG_DATA8, 0x3906, 0x10},
    {OV5640_WRITE_REG_DATA8, 0x3901, 0x0a},
    {OV5640_WRITE_REG_DATA8, 0x3731, 0x12},
    {OV5640_WRITE_REG_DATA8, 0x3600, 0x08},
    {OV5640_WRITE_REG_DATA8, 0x3601, 0x33},
    {OV5640_WRITE_REG_DATA8, 0x302d, 0x60},
    {OV5640_WRITE_REG_DATA8, 0x3620, 0x52},
    {OV5640_WRITE_REG_DATA8, 0x371b, 0x20},
    {OV5640_WRITE_REG_DATA8, 0x471c, 0x50},
    {OV5640_WRITE_REG_DATA8, 0x3a13, 0x43},
    {OV5640_WRITE_REG_DATA8, 0x3a18, 0x00},
    {OV5640_WRITE_REG_DATA8, 0x3a19, 0xf8},
    {OV5640_WRITE_REG_DATA8, 0x3635, 0x13},
    {OV5640_WRITE_REG_DATA8, 0x3636, 0x03},
    {OV5640_WRITE_REG_DATA8, 0x3634, 0x40},
    {OV5640_WRITE_REG_DATA8, 0x3622, 0x01},
    {OV5640_WRITE_REG_DATA8, 0x3c01, 0x34},
    {OV5640_WRITE_REG_DATA8, 0x3c04, 0x28},
    {OV5640_WRITE_REG_DATA8, 0x3c05, 0x98},
    {OV5640_WRITE_REG_DATA8, 0x3c06, 0x00},
    {OV5640_WRITE_REG_DATA8, 0x3c07, 0x07},
    {OV5640_WRITE_REG_DATA8, 0x3c08, 0x00},
    {OV5640_WRITE_REG_DATA8, 0x3c09, 0x1c},
    {OV5640_WRITE_REG_DATA8, 0x3c0a, 0x9c},
    {OV5640_WRITE_REG_DATA8, 0x3c0b, 0x40},
    {OV5640_WRITE_REG_DATA8, 0x3820, 0x41},
    {OV5640_WRITE_REG_DATA8, 0x3821, 0x07},
    {OV5640_WRITE_REG_DATA8, 0x3814, 0x11},
    {OV5640_WRITE_REG_DATA8, 0x3815, 0x11},
    {OV5640_WRITE_REG_DATA8, 0x3800, 0x00},
    {OV5640_WRITE_REG_DATA8, 0x3801, 0x00},
    {OV5640_WRITE_REG_DATA8, 0x3802, 0x00},
    {OV5640_WRITE_REG_DATA8, 0x3803, 0x00},
    {OV5640_WRITE_REG_DATA8, 0x3804, 0x0a},
    {OV5640_WRITE_REG_DATA8, 0x3805, 0x3f},
    {OV5640_WRITE_REG_DATA8, 0x3806, 0x07},
    {OV5640_WRITE_REG_DATA8, 0x3807, 0x9f},
    {OV5640_WRITE_REG_DATA8, 0x3808, 0x0a},
    {OV5640_WRITE_REG_DATA8, 0x3809, 0x30},
    {OV5640_WRITE_REG_DATA8, 0x380a, 0x07},
    {OV5640_WRITE_REG_DATA8, 0x380b, 0x9c},
    {OV5640_WRITE_REG_DATA8, 0x380c, 0x0b},
    {OV5640_WRITE_REG_DATA8, 0x380d, 0x1c},
    {OV5640_WRITE_REG_DATA8, 0x380e, 0x07},
    {OV5640_WRITE_REG_DATA8, 0x380f, 0xb0},
    {OV5640_WRITE_REG_DATA8, 0x3810, 0x00},
    {OV5640_WRITE_REG_DATA8, 0x3811, 0x08},
    {OV5640_WRITE_REG_DATA8, 0x3812, 0x00},
    {OV5640_WRITE_REG_DATA8, 0x3813, 0x02},
    {OV5640_WRITE_REG_DATA8, 0x3618, 0x04},
    {OV5640_WRITE_REG_DATA8, 0x3612, 0x2b},
    {OV5640_WRITE_REG_DATA8, 0x3708, 0x64},
    {OV5640_WRITE_REG_DATA8, 0x3709, 0x12},
    {OV5640_WRITE_REG_DATA8, 0x370c, 0x00},
    {OV5640_WRITE_REG_DATA8, 0x3a02, 0x07},
    {OV5640_WRITE_REG_DATA8, 0x3a03, 0xb0},
    {OV5640_WRITE_REG_DATA8, 0x3a08, 0x01},
    {OV5640_WRITE_REG_DATA8, 0x3a09, 0x27},
    {OV5640_WRITE_REG_DATA8, 0x3a0a, 0x00},
    {OV5640_WRITE_REG_DATA8, 0x3a0b, 0xf6},
    {OV5640_WRITE_REG_DATA8, 0x3a0e, 0x06},
    {OV5640_WRITE_REG_DATA8, 0x3a0d, 0x08},
    {OV5640_WRITE_REG_DATA8, 0x3a14, 0x07},
    {OV5640_WRITE_REG_DATA8, 0x3a15, 0xb0},
    {OV5640_WRITE_REG_DATA8, 0x4001, 0x02},
    {OV5640_WRITE_REG_DATA8, 0x4004, 0x06},
    {OV5640_WRITE_REG_DATA8, 0x3000, 0x00},
    {OV5640_WRITE_REG_DATA8, 0x3002, 0x1c},
    {OV5640_WRITE_REG_DATA8, 0x3004, 0xff},
    {OV5640_WRITE_REG_DATA8, 0x3006, 0xc3},
    {OV5640_WRITE_REG_DATA8, 0x300e, 0x45},
    {OV5640_WRITE_REG_DATA8, 0x302e, 0x08},
    {OV5640_WRITE_REG_DATA8, 0x4300, 0x32},
    //{OV5640_WRITE_REG_DATA8, 0x4800, 0x24},
    {OV5640_WRITE_REG_DATA8, 0x4837, 0x0a},
    {OV5640_WRITE_REG_DATA8, 0x501f, 0x00},
    {OV5640_WRITE_REG_DATA8, 0x440e, 0x00},
    {OV5640_WRITE_REG_DATA8, 0x5000, 0xa7},
    {OV5640_WRITE_REG_DATA8, 0x5001, 0x83},
    {OV5640_WRITE_REG_DATA8, 0x5180, 0xff},
    {OV5640_WRITE_REG_DATA8, 0x5181, 0xf2},
    {OV5640_WRITE_REG_DATA8, 0x5182, 0x00},
    {OV5640_WRITE_REG_DATA8, 0x5183, 0x14},
    {OV5640_WRITE_REG_DATA8, 0x5184, 0x25},
    {OV5640_WRITE_REG_DATA8, 0x5185, 0x24},
    {OV5640_WRITE_REG_DATA8, 0x5186, 0x09},
    {OV5640_WRITE_REG_DATA8, 0x5187, 0x09},
    {OV5640_WRITE_REG_DATA8, 0x5188, 0x09},
    {OV5640_WRITE_REG_DATA8, 0x5189, 0x75},
    {OV5640_WRITE_REG_DATA8, 0x518a, 0x54},
    {OV5640_WRITE_REG_DATA8, 0x518b, 0xe0},
    {OV5640_WRITE_REG_DATA8, 0x518c, 0xb2},
    {OV5640_WRITE_REG_DATA8, 0x518d, 0x42},
    {OV5640_WRITE_REG_DATA8, 0x518e, 0x3d},
    {OV5640_WRITE_REG_DATA8, 0x518f, 0x56},
    {OV5640_WRITE_REG_DATA8, 0x5190, 0x46},
    {OV5640_WRITE_REG_DATA8, 0x5191, 0xf8},
    {OV5640_WRITE_REG_DATA8, 0x5192, 0x04},
    {OV5640_WRITE_REG_DATA8, 0x5193, 0x70},
    {OV5640_WRITE_REG_DATA8, 0x5194, 0xf0},
    {OV5640_WRITE_REG_DATA8, 0x5195, 0xf0},
    {OV5640_WRITE_REG_DATA8, 0x5196, 0x03},
    {OV5640_WRITE_REG_DATA8, 0x5197, 0x01},
    {OV5640_WRITE_REG_DATA8, 0x5198, 0x04},
    {OV5640_WRITE_REG_DATA8, 0x5199, 0x12},
    {OV5640_WRITE_REG_DATA8, 0x519a, 0x04},
    {OV5640_WRITE_REG_DATA8, 0x519b, 0x00},
    {OV5640_WRITE_REG_DATA8, 0x519c, 0x06},
    {OV5640_WRITE_REG_DATA8, 0x519d, 0x82},
    {OV5640_WRITE_REG_DATA8, 0x519e, 0x38},
    {OV5640_WRITE_REG_DATA8, 0x5381, 0x1e},
    {OV5640_WRITE_REG_DATA8, 0x5382, 0x5b},
    {OV5640_WRITE_REG_DATA8, 0x5383, 0x08},
    {OV5640_WRITE_REG_DATA8, 0x5384, 0x0a},
    {OV5640_WRITE_REG_DATA8, 0x5385, 0x7e},
    {OV5640_WRITE_REG_DATA8, 0x5386, 0x88},
    {OV5640_WRITE_REG_DATA8, 0x5387, 0x7c},
    {OV5640_WRITE_REG_DATA8, 0x5388, 0x6c},
    {OV5640_WRITE_REG_DATA8, 0x5389, 0x10},
    {OV5640_WRITE_REG_DATA8, 0x538a, 0x01},
    {OV5640_WRITE_REG_DATA8, 0x538b, 0x98},
    {OV5640_WRITE_REG_DATA8, 0x5300, 0x08},
    {OV5640_WRITE_REG_DATA8, 0x5301, 0x30},
    {OV5640_WRITE_REG_DATA8, 0x5302, 0x10},
    {OV5640_WRITE_REG_DATA8, 0x5303, 0x00},
    {OV5640_WRITE_REG_DATA8, 0x5304, 0x08},
    {OV5640_WRITE_REG_DATA8, 0x5305, 0x30},
    {OV5640_WRITE_REG_DATA8, 0x5306, 0x08},
    {OV5640_WRITE_REG_DATA8, 0x5307, 0x16},
    {OV5640_WRITE_REG_DATA8, 0x5309, 0x08},
    {OV5640_WRITE_REG_DATA8, 0x530a, 0x30},
    {OV5640_WRITE_REG_DATA8, 0x530b, 0x04},
    {OV5640_WRITE_REG_DATA8, 0x530c, 0x06},
    {OV5640_WRITE_REG_DATA8, 0x5480, 0x01},
    {OV5640_WRITE_REG_DATA8, 0x5481, 0x08},
    {OV5640_WRITE_REG_DATA8, 0x5482, 0x14},
    {OV5640_WRITE_REG_DATA8, 0x5483, 0x28},
    {OV5640_WRITE_REG_DATA8, 0x5484, 0x51},
    {OV5640_WRITE_REG_DATA8, 0x5485, 0x65},
    {OV5640_WRITE_REG_DATA8, 0x5486, 0x71},
    {OV5640_WRITE_REG_DATA8, 0x5487, 0x7d},
    {OV5640_WRITE_REG_DATA8, 0x5488, 0x87},
    {OV5640_WRITE_REG_DATA8, 0x5489, 0x91},
    {OV5640_WRITE_REG_DATA8, 0x548a, 0x9a},
    {OV5640_WRITE_REG_DATA8, 0x548b, 0xaa},
    {OV5640_WRITE_REG_DATA8, 0x548c, 0xb8},
    {OV5640_WRITE_REG_DATA8, 0x548d, 0xcd},
    {OV5640_WRITE_REG_DATA8, 0x548e, 0xdd},
    {OV5640_WRITE_REG_DATA8, 0x548f, 0xea},
    {OV5640_WRITE_REG_DATA8, 0x5490, 0x1d},
    {OV5640_WRITE_REG_DATA8, 0x5580, 0x02},
    {OV5640_WRITE_REG_DATA8, 0x5583, 0x40},
    {OV5640_WRITE_REG_DATA8, 0x5584, 0x10},
    {OV5640_WRITE_REG_DATA8, 0x5589, 0x10},
    {OV5640_WRITE_REG_DATA8, 0x558a, 0x00},
    {OV5640_WRITE_REG_DATA8, 0x558b, 0xf8},
    {OV5640_WRITE_REG_DATA8, 0x5800, 0x23},
    {OV5640_WRITE_REG_DATA8, 0x5801, 0x14},
    {OV5640_WRITE_REG_DATA8, 0x5802, 0x0f},
    {OV5640_WRITE_REG_DATA8, 0x5803, 0x0f},
    {OV5640_WRITE_REG_DATA8, 0x5804, 0x12},
    {OV5640_WRITE_REG_DATA8, 0x5805, 0x26},
    {OV5640_WRITE_REG_DATA8, 0x5806, 0x0c},
    {OV5640_WRITE_REG_DATA8, 0x5807, 0x08},
    {OV5640_WRITE_REG_DATA8, 0x5808, 0x05},
    {OV5640_WRITE_REG_DATA8, 0x5809, 0x05},
    {OV5640_WRITE_REG_DATA8, 0x580a, 0x08},
    {OV5640_WRITE_REG_DATA8, 0x580b, 0x0d},
    {OV5640_WRITE_REG_DATA8, 0x580c, 0x08},
    {OV5640_WRITE_REG_DATA8, 0x580d, 0x03},
    {OV5640_WRITE_REG_DATA8, 0x580e, 0x00},
    {OV5640_WRITE_REG_DATA8, 0x580f, 0x00},
    {OV5640_WRITE_REG_DATA8, 0x5810, 0x03},
    {OV5640_WRITE_REG_DATA8, 0x5811, 0x09},
    {OV5640_WRITE_REG_DATA8, 0x5812, 0x07},
    {OV5640_WRITE_REG_DATA8, 0x5813, 0x03},
    {OV5640_WRITE_REG_DATA8, 0x5814, 0x00},
    {OV5640_WRITE_REG_DATA8, 0x5815, 0x01},
    {OV5640_WRITE_REG_DATA8, 0x5816, 0x03},
    {OV5640_WRITE_REG_DATA8, 0x5817, 0x08},
    {OV5640_WRITE_REG_DATA8, 0x5818, 0x0d},
    {OV5640_WRITE_REG_DATA8, 0x5819, 0x08},
    {OV5640_WRITE_REG_DATA8, 0x581a, 0x05},
    {OV5640_WRITE_REG_DATA8, 0x581b, 0x06},
    {OV5640_WRITE_REG_DATA8, 0x581c, 0x08},
    {OV5640_WRITE_REG_DATA8, 0x581d, 0x0e},
    {OV5640_WRITE_REG_DATA8, 0x581e, 0x29},
    {OV5640_WRITE_REG_DATA8, 0x581f, 0x17},
    {OV5640_WRITE_REG_DATA8, 0x5820, 0x11},
    {OV5640_WRITE_REG_DATA8, 0x5821, 0x11},
    {OV5640_WRITE_REG_DATA8, 0x5822, 0x15},
    {OV5640_WRITE_REG_DATA8, 0x5823, 0x28},
    {OV5640_WRITE_REG_DATA8, 0x5824, 0x46},
    {OV5640_WRITE_REG_DATA8, 0x5825, 0x26},
    {OV5640_WRITE_REG_DATA8, 0x5826, 0x08},
    {OV5640_WRITE_REG_DATA8, 0x5827, 0x26},
    {OV5640_WRITE_REG_DATA8, 0x5828, 0x64},
    {OV5640_WRITE_REG_DATA8, 0x5829, 0x26},
    {OV5640_WRITE_REG_DATA8, 0x582a, 0x24},
    {OV5640_WRITE_REG_DATA8, 0x582b, 0x22},
    {OV5640_WRITE_REG_DATA8, 0x582c, 0x24},
    {OV5640_WRITE_REG_DATA8, 0x582d, 0x24},
    {OV5640_WRITE_REG_DATA8, 0x582e, 0x06},
    {OV5640_WRITE_REG_DATA8, 0x582f, 0x22},
    {OV5640_WRITE_REG_DATA8, 0x5830, 0x40},
    {OV5640_WRITE_REG_DATA8, 0x5831, 0x42},
    {OV5640_WRITE_REG_DATA8, 0x5832, 0x24},
    {OV5640_WRITE_REG_DATA8, 0x5833, 0x26},
    {OV5640_WRITE_REG_DATA8, 0x5834, 0x24},
    {OV5640_WRITE_REG_DATA8, 0x5835, 0x22},
    {OV5640_WRITE_REG_DATA8, 0x5836, 0x22},
    {OV5640_WRITE_REG_DATA8, 0x5837, 0x26},
    {OV5640_WRITE_REG_DATA8, 0x5838, 0x44},
    {OV5640_WRITE_REG_DATA8, 0x5839, 0x24},
    {OV5640_WRITE_REG_DATA8, 0x583a, 0x26},
    {OV5640_WRITE_REG_DATA8, 0x583b, 0x28},
    {OV5640_WRITE_REG_DATA8, 0x583c, 0x42},
    {OV5640_WRITE_REG_DATA8, 0x583d, 0xce},
    {OV5640_WRITE_REG_DATA8, 0x5025, 0x00},
    {OV5640_WRITE_REG_DATA8, 0x3a0f, 0x30},
    {OV5640_WRITE_REG_DATA8, 0x3a10, 0x28},
    {OV5640_WRITE_REG_DATA8, 0x3a1b, 0x30},
    {OV5640_WRITE_REG_DATA8, 0x3a1e, 0x26},
    {OV5640_WRITE_REG_DATA8, 0x3a11, 0x60},
    {OV5640_WRITE_REG_DATA8, 0x3a1f, 0x14},
    {OV5640_WRITE_REG_DATA8, 0x3008, 0x02},

    //{OV5640_WRITE_REG_DATA8, 0x4201, 0x00}, // start after 1 frame
    //{OV5640_WRITE_REG_DATA8, 0x4202, 0x01},
    {OV5640_WAIT_MS, 0x0000, 100},
    {OV5640_TABLE_END, 0x0000, 0x00}

};

char ov5640_af_fw[] = {
0x02, 0x0F, 0x42, 0x02, 0x0A, 0x5D, 0xC2, 0x01, 0x22, 0x22, 0x00, 0x02, 0x0F, 0x1E, 0xE5, 0x1F,
0x70, 0x72, 0xF5, 0x1E, 0xD2, 0x35, 0xFF, 0xEF, 0x25, 0xE0, 0x24, 0x4E, 0xF8, 0xE4, 0xF6, 0x08,
0xF6, 0x0F, 0xBF, 0x34, 0xF2, 0x90, 0x0E, 0x93, 0xE4, 0x93, 0xFF, 0xE5, 0x4B, 0xC3, 0x9F, 0x50,
0x04, 0x7F, 0x04, 0x80, 0x02, 0x7F, 0xFC, 0x78, 0xBD, 0xA6, 0x07, 0x12, 0x0D, 0xD1, 0x40, 0x04,
0x7F, 0x03, 0x80, 0x02, 0x7F, 0x30, 0x78, 0xBC, 0xA6, 0x07, 0xE6, 0x18, 0xF6, 0x08, 0xE6, 0x78,
0xB9, 0xF6, 0x78, 0xBC, 0xE6, 0x78, 0xBA, 0xF6, 0x78, 0xBF, 0x76, 0x33, 0xE4, 0x08, 0xF6, 0x78,
0xB8, 0x76, 0x01, 0x75, 0x4A, 0x02, 0x78, 0xB6, 0xF6, 0x08, 0xF6, 0x74, 0xFF, 0x78, 0xC1, 0xF6,
0x08, 0xF6, 0x75, 0x1F, 0x01, 0x78, 0xBC, 0xE6, 0x75, 0xF0, 0x05, 0xA4, 0xF5, 0x4B, 0x12, 0x0B,
0x23, 0xC2, 0x37, 0x22, 0x78, 0xB8, 0xE6, 0xD3, 0x94, 0x00, 0x40, 0x02, 0x16, 0x22, 0xE5, 0x1F,
0x64, 0x05, 0x70, 0x28, 0xF5, 0x1F, 0xC2, 0x01, 0x78, 0xB9, 0xE6, 0x25, 0xE0, 0x24, 0x4E, 0xF8,
0xE6, 0xFE, 0x08, 0xE6, 0xFF, 0x78, 0x4E, 0xA6, 0x06, 0x08, 0xA6, 0x07, 0xA2, 0x37, 0xE4, 0x33,
0xF5, 0x3C, 0x90, 0x30, 0x28, 0xF0, 0x75, 0x1E, 0x10, 0xD2, 0x35, 0x22, 0xE5, 0x4B, 0x75, 0xF0,
0x05, 0x84, 0x78, 0xBC, 0xF6, 0x90, 0x0E, 0x8C, 0xE4, 0x93, 0xFF, 0x25, 0xE0, 0x24, 0x0A, 0xF8,
0xE6, 0xFC, 0x08, 0xE6, 0xFD, 0x78, 0xBC, 0xE6, 0x25, 0xE0, 0x24, 0x4E, 0xF8, 0xA6, 0x04, 0x08,
0xA6, 0x05, 0xEF, 0x12, 0x0D, 0xD8, 0xD3, 0x78, 0xB7, 0x96, 0xEE, 0x18, 0x96, 0x40, 0x0D, 0x78,
0xBC, 0xE6, 0x78, 0xB9, 0xF6, 0x78, 0xB6, 0xA6, 0x06, 0x08, 0xA6, 0x07, 0x90, 0x0E, 0x8C, 0xE4,
0x93, 0x12, 0x0D, 0xD8, 0xC3, 0x78, 0xC2, 0x96, 0xEE, 0x18, 0x96, 0x50, 0x0D, 0x78, 0xBC, 0xE6,
0x78, 0xBA, 0xF6, 0x78, 0xC1, 0xA6, 0x06, 0x08, 0xA6, 0x07, 0x78, 0xB6, 0xE6, 0xFE, 0x08, 0xE6,
0xC3, 0x78, 0xC2, 0x96, 0xFF, 0xEE, 0x18, 0x96, 0x78, 0xC3, 0xF6, 0x08, 0xA6, 0x07, 0x90, 0x0E,
0x95, 0xE4, 0x18, 0x12, 0x0D, 0xB6, 0xC3, 0x33, 0xCE, 0x33, 0xCE, 0xD8, 0xF9, 0xFF, 0xD3, 0xED,
0x9F, 0xEC, 0x9E, 0x40, 0x02, 0xD2, 0x37, 0x78, 0xBC, 0xE6, 0x08, 0x26, 0x08, 0xF6, 0xE5, 0x1F,
0x64, 0x01, 0x70, 0x55, 0xE6, 0xC3, 0x78, 0xC0, 0x12, 0x0D, 0xAC, 0x40, 0x10, 0x12, 0x0D, 0xA7,
0x50, 0x0B, 0x30, 0x37, 0x41, 0x78, 0xBC, 0xE6, 0x78, 0xB9, 0x66, 0x60, 0x39, 0x12, 0x0D, 0xCF,
0x40, 0x04, 0x7F, 0xFE, 0x80, 0x02, 0x7F, 0x02, 0x78, 0xBD, 0xA6, 0x07, 0x78, 0xB9, 0xE6, 0x24,
0x03, 0x78, 0xBF, 0xF6, 0x78, 0xB9, 0xE6, 0x24, 0xFD, 0x78, 0xC0, 0xF6, 0x12, 0x0D, 0xCF, 0x40,
0x06, 0x78, 0xC0, 0xE6, 0xFF, 0x80, 0x04, 0x78, 0xBF, 0xE6, 0xFF, 0x78, 0xBE, 0xA6, 0x07, 0x75,
0x1F, 0x02, 0x78, 0xB8, 0x76, 0x01, 0x02, 0x02, 0x68, 0xE5, 0x1F, 0x64, 0x02, 0x60, 0x03, 0x02,
0x02, 0x48, 0x78, 0xBE, 0xE6, 0xFF, 0xC3, 0x78, 0xC0, 0x12, 0x0D, 0xAD, 0x40, 0x08, 0x12, 0x0D,
0xA7, 0x50, 0x03, 0x02, 0x02, 0x46, 0x12, 0x0D, 0xCF, 0x40, 0x04, 0x7F, 0xFF, 0x80, 0x02, 0x7F,
0x01, 0x78, 0xBD, 0xA6, 0x07, 0x78, 0xB9, 0xE6, 0x04, 0x78, 0xBF, 0xF6, 0x78, 0xB9, 0xE6, 0x14,
0x78, 0xC0, 0xF6, 0x18, 0x12, 0x0D, 0xD1, 0x40, 0x04, 0xE6, 0xFF, 0x80, 0x02, 0x7F, 0x00, 0x78,
0xBF, 0xA6, 0x07, 0xD3, 0x08, 0xE6, 0x64, 0x80, 0x94, 0x80, 0x40, 0x04, 0xE6, 0xFF, 0x80, 0x02,
0x7F, 0x00, 0x78, 0xC0, 0xA6, 0x07, 0xC3, 0x18, 0xE6, 0x64, 0x80, 0x94, 0xB3, 0x50, 0x04, 0xE6,
0xFF, 0x80, 0x02, 0x7F, 0x33, 0x78, 0xBF, 0xA6, 0x07, 0xC3, 0x08, 0xE6, 0x64, 0x80, 0x94, 0xB3,
0x50, 0x04, 0xE6, 0xFF, 0x80, 0x02, 0x7F, 0x33, 0x78, 0xC0, 0xA6, 0x07, 0x12, 0x0D, 0xCF, 0x40,
0x06, 0x78, 0xC0, 0xE6, 0xFF, 0x80, 0x04, 0x78, 0xBF, 0xE6, 0xFF, 0x78, 0xBE, 0xA6, 0x07, 0x75,
0x1F, 0x03, 0x78, 0xB8, 0x76, 0x01, 0x80, 0x20, 0xE5, 0x1F, 0x64, 0x03, 0x70, 0x26, 0x78, 0xBE,
0xE6, 0xFF, 0xC3, 0x78, 0xC0, 0x12, 0x0D, 0xAD, 0x40, 0x05, 0x12, 0x0D, 0xA7, 0x40, 0x09, 0x78,
0xB9, 0xE6, 0x78, 0xBE, 0xF6, 0x75, 0x1F, 0x04, 0x78, 0xBE, 0xE6, 0x75, 0xF0, 0x05, 0xA4, 0xF5,
0x4B, 0x02, 0x0B, 0x23, 0xE5, 0x1F, 0xB4, 0x04, 0x1D, 0x90, 0x0E, 0x94, 0xE4, 0x78, 0xC3, 0x12,
0x0D, 0xB6, 0xC3, 0x33, 0xCE, 0x33, 0xCE, 0xD8, 0xF9, 0xFF, 0xD3, 0xED, 0x9F, 0xEC, 0x9E, 0x40,
0x02, 0xD2, 0x37, 0x75, 0x1F, 0x05, 0x22, 0x30, 0x01, 0x03, 0x02, 0x04, 0xF1, 0x30, 0x02, 0x03,
0x02, 0x04, 0xF1, 0x90, 0x51, 0xA5, 0xE0, 0x78, 0x93, 0xF6, 0xA3, 0xE0, 0x08, 0xF6, 0xA3, 0xE0,
0x08, 0xF6, 0xE5, 0x1F, 0x70, 0x3C, 0x75, 0x1E, 0x20, 0xD2, 0x35, 0x12, 0x0D, 0x89, 0x78, 0x7E,
0xA6, 0x06, 0x08, 0xA6, 0x07, 0x78, 0x8B, 0xA6, 0x09, 0x18, 0x76, 0x01, 0x12, 0x0D, 0x79, 0x78,
0x4E, 0xA6, 0x06, 0x08, 0xA6, 0x07, 0x78, 0x8B, 0xE6, 0x78, 0x6E, 0xF6, 0x75, 0x1F, 0x01, 0x78,
0x93, 0xE6, 0x78, 0x90, 0xF6, 0x78, 0x94, 0xE6, 0x78, 0x91, 0xF6, 0x78, 0x95, 0xE6, 0x78, 0x92,
0xF6, 0x22, 0x79, 0x90, 0xE7, 0xD3, 0x78, 0x93, 0x96, 0x40, 0x05, 0xE7, 0x96, 0xFF, 0x80, 0x08,
0xC3, 0x79, 0x93, 0xE7, 0x78, 0x90, 0x96, 0xFF, 0x78, 0x88, 0x76, 0x00, 0x08, 0xA6, 0x07, 0x79,
0x91, 0xE7, 0xD3, 0x78, 0x94, 0x96, 0x40, 0x05, 0xE7, 0x96, 0xFF, 0x80, 0x08, 0xC3, 0x79, 0x94,
0xE7, 0x78, 0x91, 0x96, 0xFF, 0x12, 0x0D, 0x9D, 0x79, 0x92, 0xE7, 0xD3, 0x78, 0x95, 0x96, 0x40,
0x05, 0xE7, 0x96, 0xFF, 0x80, 0x08, 0xC3, 0x79, 0x95, 0xE7, 0x78, 0x92, 0x96, 0xFF, 0x12, 0x0D,
0x9D, 0x12, 0x0D, 0x79, 0x78, 0x8A, 0xE6, 0x25, 0xE0, 0x24, 0x4E, 0xF8, 0xA6, 0x06, 0x08, 0xA6,
0x07, 0x78, 0x8A, 0xE6, 0x24, 0x6E, 0xF8, 0xA6, 0x09, 0x78, 0x8A, 0xE6, 0x24, 0x01, 0xFF, 0xE4,
0x33, 0xFE, 0xD3, 0xEF, 0x94, 0x0F, 0xEE, 0x64, 0x80, 0x94, 0x80, 0x40, 0x04, 0x7F, 0x00, 0x80,
0x05, 0x78, 0x8A, 0xE6, 0x04, 0xFF, 0x78, 0x8A, 0xA6, 0x07, 0xE5, 0x1F, 0xB4, 0x01, 0x0A, 0xE6,
0x60, 0x03, 0x02, 0x04, 0xF1, 0x75, 0x1F, 0x02, 0x22, 0x12, 0x0D, 0x89, 0x78, 0x80, 0xA6, 0x06,
0x08, 0xA6, 0x07, 0x12, 0x0D, 0x89, 0x78, 0x82, 0xA6, 0x06, 0x08, 0xA6, 0x07, 0x78, 0x6E, 0xE6,
0x78, 0x8C, 0xF6, 0x78, 0x6E, 0xE6, 0x78, 0x8D, 0xF6, 0x7F, 0x01, 0xEF, 0x25, 0xE0, 0x24, 0x4F,
0xF9, 0xC3, 0x78, 0x81, 0xE6, 0x97, 0x18, 0xE6, 0x19, 0x97, 0x50, 0x0A, 0x12, 0x0D, 0x91, 0x78,
0x80, 0xA6, 0x04, 0x08, 0xA6, 0x05, 0x74, 0x6E, 0x2F, 0xF9, 0x78, 0x8C, 0xE6, 0xC3, 0x97, 0x50,
0x08, 0x74, 0x6E, 0x2F, 0xF8, 0xE6, 0x78, 0x8C, 0xF6, 0xEF, 0x25, 0xE0, 0x24, 0x4F, 0xF9, 0xD3,
0x78, 0x83, 0xE6, 0x97, 0x18, 0xE6, 0x19, 0x97, 0x40, 0x0A, 0x12, 0x0D, 0x91, 0x78, 0x82, 0xA6,
0x04, 0x08, 0xA6, 0x05, 0x74, 0x6E, 0x2F, 0xF9, 0x78, 0x8D, 0xE6, 0xD3, 0x97, 0x40, 0x08, 0x74,
0x6E, 0x2F, 0xF8, 0xE6, 0x78, 0x8D, 0xF6, 0x0F, 0xEF, 0x64, 0x10, 0x70, 0x9E, 0xC3, 0x79, 0x81,
0xE7, 0x78, 0x83, 0x96, 0xFF, 0x19, 0xE7, 0x18, 0x96, 0x78, 0x84, 0xF6, 0x08, 0xA6, 0x07, 0xC3,
0x79, 0x8C, 0xE7, 0x78, 0x8D, 0x96, 0x08, 0xF6, 0xD3, 0x79, 0x81, 0xE7, 0x78, 0x7F, 0x96, 0x19,
0xE7, 0x18, 0x96, 0x40, 0x05, 0x09, 0xE7, 0x08, 0x80, 0x06, 0xC3, 0x79, 0x7F, 0xE7, 0x78, 0x81,
0x96, 0xFF, 0x19, 0xE7, 0x18, 0x96, 0xFE, 0x78, 0x86, 0xA6, 0x06, 0x08, 0xA6, 0x07, 0x79, 0x8C,
0xE7, 0xD3, 0x78, 0x8B, 0x96, 0x40, 0x05, 0xE7, 0x96, 0xFF, 0x80, 0x08, 0xC3, 0x79, 0x8B, 0xE7,
0x78, 0x8C, 0x96, 0xFF, 0x78, 0x8F, 0xA6, 0x07, 0xE5, 0x1F, 0x64, 0x02, 0x70, 0x6F, 0x90, 0x0E,
0x91, 0x93, 0xFF, 0x18, 0xE6, 0xC3, 0x9F, 0x50, 0x78, 0x90, 0x0E, 0x8E, 0x78, 0x84, 0x12, 0x0D,
0x67, 0x78, 0x80, 0xE6, 0xFE, 0x08, 0xE6, 0x78, 0x02, 0xC3, 0x33, 0xCE, 0x33, 0xCE, 0xD8, 0xF9,
0xFF, 0xC3, 0xED, 0x9F, 0xEC, 0x9E, 0x50, 0x59, 0x90, 0x0E, 0x92, 0xE4, 0x93, 0xFF, 0x78, 0x8F,
0xE6, 0x9F, 0x40, 0x02, 0x80, 0x11, 0x90, 0x0E, 0x90, 0xE4, 0x93, 0xFF, 0xD3, 0x78, 0x89, 0xE6,
0x9F, 0x18, 0xE6, 0x94, 0x00, 0x40, 0x03, 0x75, 0x1F, 0x05, 0x90, 0x0E, 0x8F, 0x78, 0x86, 0x12,
0x0D, 0x67, 0x78, 0x7E, 0xE6, 0xFE, 0x08, 0xE6, 0x78, 0x02, 0xC3, 0x33, 0xCE, 0x33, 0xCE, 0xD8,
0xF9, 0xFF, 0xD3, 0xED, 0x9F, 0xEC, 0x9E, 0x40, 0x18, 0x75, 0x1F, 0x05, 0x22, 0xE5, 0x1F, 0xB4,
0x05, 0x0F, 0xD2, 0x01, 0xC2, 0x02, 0xE4, 0xF5, 0x1F, 0xF5, 0x1E, 0xD2, 0x35, 0xD2, 0x33, 0xD2,
0x36, 0x22, 0xEF, 0x8D, 0xF0, 0xA4, 0xA8, 0xF0, 0xCF, 0x8C, 0xF0, 0xA4, 0x28, 0xCE, 0x8D, 0xF0,
0xA4, 0x2E, 0xFE, 0x22, 0xBC, 0x00, 0x0B, 0xBE, 0x00, 0x29, 0xEF, 0x8D, 0xF0, 0x84, 0xFF, 0xAD,
0xF0, 0x22, 0xE4, 0xCC, 0xF8, 0x75, 0xF0, 0x08, 0xEF, 0x2F, 0xFF, 0xEE, 0x33, 0xFE, 0xEC, 0x33,
0xFC, 0xEE, 0x9D, 0xEC, 0x98, 0x40, 0x05, 0xFC, 0xEE, 0x9D, 0xFE, 0x0F, 0xD5, 0xF0, 0xE9, 0xE4,
0xCE, 0xFD, 0x22, 0xED, 0xF8, 0xF5, 0xF0, 0xEE, 0x84, 0x20, 0xD2, 0x1C, 0xFE, 0xAD, 0xF0, 0x75,
0xF0, 0x08, 0xEF, 0x2F, 0xFF, 0xED, 0x33, 0xFD, 0x40, 0x07, 0x98, 0x50, 0x06, 0xD5, 0xF0, 0xF2,
0x22, 0xC3, 0x98, 0xFD, 0x0F, 0xD5, 0xF0, 0xEA, 0x22, 0xE8, 0x8F, 0xF0, 0xA4, 0xCC, 0x8B, 0xF0,
0xA4, 0x2C, 0xFC, 0xE9, 0x8E, 0xF0, 0xA4, 0x2C, 0xFC, 0x8A, 0xF0, 0xED, 0xA4, 0x2C, 0xFC, 0xEA,
0x8E, 0xF0, 0xA4, 0xCD, 0xA8, 0xF0, 0x8B, 0xF0, 0xA4, 0x2D, 0xCC, 0x38, 0x25, 0xF0, 0xFD, 0xE9,
0x8F, 0xF0, 0xA4, 0x2C, 0xCD, 0x35, 0xF0, 0xFC, 0xEB, 0x8E, 0xF0, 0xA4, 0xFE, 0xA9, 0xF0, 0xEB,
0x8F, 0xF0, 0xA4, 0xCF, 0xC5, 0xF0, 0x2E, 0xCD, 0x39, 0xFE, 0xE4, 0x3C, 0xFC, 0xEA, 0xA4, 0x2D,
0xCE, 0x35, 0xF0, 0xFD, 0xE4, 0x3C, 0xFC, 0x22, 0x75, 0xF0, 0x08, 0x75, 0x82, 0x00, 0xEF, 0x2F,
0xFF, 0xEE, 0x33, 0xFE, 0xCD, 0x33, 0xCD, 0xCC, 0x33, 0xCC, 0xC5, 0x82, 0x33, 0xC5, 0x82, 0x9B,
0xED, 0x9A, 0xEC, 0x99, 0xE5, 0x82, 0x98, 0x40, 0x0C, 0xF5, 0x82, 0xEE, 0x9B, 0xFE, 0xED, 0x9A,
0xFD, 0xEC, 0x99, 0xFC, 0x0F, 0xD5, 0xF0, 0xD6, 0xE4, 0xCE, 0xFB, 0xE4, 0xCD, 0xFA, 0xE4, 0xCC,
0xF9, 0xA8, 0x82, 0x22, 0xB8, 0x00, 0xC1, 0xB9, 0x00, 0x59, 0xBA, 0x00, 0x2D, 0xEC, 0x8B, 0xF0,
0x84, 0xCF, 0xCE, 0xCD, 0xFC, 0xE5, 0xF0, 0xCB, 0xF9, 0x78, 0x18, 0xEF, 0x2F, 0xFF, 0xEE, 0x33,
0xFE, 0xED, 0x33, 0xFD, 0xEC, 0x33, 0xFC, 0xEB, 0x33, 0xFB, 0x10, 0xD7, 0x03, 0x99, 0x40, 0x04,
0xEB, 0x99, 0xFB, 0x0F, 0xD8, 0xE5, 0xE4, 0xF9, 0xFA, 0x22, 0x78, 0x18, 0xEF, 0x2F, 0xFF, 0xEE,
0x33, 0xFE, 0xED, 0x33, 0xFD, 0xEC, 0x33, 0xFC, 0xC9, 0x33, 0xC9, 0x10, 0xD7, 0x05, 0x9B, 0xE9,
0x9A, 0x40, 0x07, 0xEC, 0x9B, 0xFC, 0xE9, 0x9A, 0xF9, 0x0F, 0xD8, 0xE0, 0xE4, 0xC9, 0xFA, 0xE4,
0xCC, 0xFB, 0x22, 0x75, 0xF0, 0x10, 0xEF, 0x2F, 0xFF, 0xEE, 0x33, 0xFE, 0xED, 0x33, 0xFD, 0xCC,
0x33, 0xCC, 0xC8, 0x33, 0xC8, 0x10, 0xD7, 0x07, 0x9B, 0xEC, 0x9A, 0xE8, 0x99, 0x40, 0x0A, 0xED,
0x9B, 0xFD, 0xEC, 0x9A, 0xFC, 0xE8, 0x99, 0xF8, 0x0F, 0xD5, 0xF0, 0xDA, 0xE4, 0xCD, 0xFB, 0xE4,
0xCC, 0xFA, 0xE4, 0xC8, 0xF9, 0x22, 0xEB, 0x9F, 0xF5, 0xF0, 0xEA, 0x9E, 0x42, 0xF0, 0xE9, 0x9D,
0x42, 0xF0, 0xE8, 0x9C, 0x45, 0xF0, 0x22, 0xE8, 0x60, 0x0F, 0xEF, 0xC3, 0x33, 0xFF, 0xEE, 0x33,
0xFE, 0xED, 0x33, 0xFD, 0xEC, 0x33, 0xFC, 0xD8, 0xF1, 0x22, 0xE4, 0x93, 0xFC, 0x74, 0x01, 0x93,
0xFD, 0x74, 0x02, 0x93, 0xFE, 0x74, 0x03, 0x93, 0xFF, 0x22, 0xE6, 0xFB, 0x08, 0xE6, 0xF9, 0x08,
0xE6, 0xFA, 0x08, 0xE6, 0xCB, 0xF8, 0x22, 0xEC, 0xF6, 0x08, 0xED, 0xF6, 0x08, 0xEE, 0xF6, 0x08,
0xEF, 0xF6, 0x22, 0xA4, 0x25, 0x82, 0xF5, 0x82, 0xE5, 0xF0, 0x35, 0x83, 0xF5, 0x83, 0x22, 0xD0,
0x83, 0xD0, 0x82, 0xF8, 0xE4, 0x93, 0x70, 0x12, 0x74, 0x01, 0x93, 0x70, 0x0D, 0xA3, 0xA3, 0x93,
0xF8, 0x74, 0x01, 0x93, 0xF5, 0x82, 0x88, 0x83, 0xE4, 0x73, 0x74, 0x02, 0x93, 0x68, 0x60, 0xEF,
0xA3, 0xA3, 0xA3, 0x80, 0xDF, 0x90, 0x38, 0x04, 0x78, 0x52, 0x12, 0x0C, 0x21, 0x90, 0x38, 0x00,
0xE0, 0xFE, 0xA3, 0xE0, 0xFD, 0xED, 0xFF, 0xC3, 0x12, 0x0B, 0xC2, 0x90, 0x38, 0x10, 0x12, 0x0B,
0xB6, 0x90, 0x38, 0x06, 0x78, 0x54, 0x12, 0x0C, 0x21, 0x90, 0x38, 0x02, 0xE0, 0xFE, 0xA3, 0xE0,
0xFD, 0xED, 0xFF, 0xC3, 0x12, 0x0B, 0xC2, 0x90, 0x38, 0x12, 0x12, 0x0B, 0xB6, 0xA3, 0xE0, 0xB4,
0x31, 0x07, 0x78, 0x52, 0x79, 0x52, 0x12, 0x0C, 0x37, 0x90, 0x38, 0x14, 0xE0, 0xB4, 0x71, 0x15,
0x78, 0x52, 0xE6, 0xFE, 0x08, 0xE6, 0x78, 0x02, 0xCE, 0xC3, 0x13, 0xCE, 0x13, 0xD8, 0xF9, 0x79,
0x53, 0xF7, 0xEE, 0x19, 0xF7, 0x90, 0x38, 0x15, 0xE0, 0xB4, 0x31, 0x07, 0x78, 0x54, 0x79, 0x54,
0x12, 0x0C, 0x37, 0x90, 0x38, 0x15, 0xE0, 0xB4, 0x71, 0x15, 0x78, 0x54, 0xE6, 0xFE, 0x08, 0xE6,
0x78, 0x02, 0xCE, 0xC3, 0x13, 0xCE, 0x13, 0xD8, 0xF9, 0x79, 0x55, 0xF7, 0xEE, 0x19, 0xF7, 0x79,
0x52, 0x12, 0x0B, 0xFD, 0x09, 0x12, 0x0B, 0xFD, 0xAF, 0x47, 0x12, 0x0B, 0xD6, 0xE5, 0x44, 0xFB,
0x7A, 0x00, 0xFD, 0x7C, 0x00, 0x12, 0x05, 0x04, 0x78, 0x5A, 0xA6, 0x06, 0x08, 0xA6, 0x07, 0xAF,
0x45, 0x12, 0x0B, 0xD6, 0xAD, 0x03, 0x7C, 0x00, 0x12, 0x05, 0x04, 0x78, 0x56, 0xA6, 0x06, 0x08,
0xA6, 0x07, 0xAF, 0x48, 0x78, 0x54, 0x12, 0x0B, 0xD8, 0xE5, 0x43, 0xFB, 0xFD, 0x7C, 0x00, 0x12,
0x05, 0x04, 0x78, 0x5C, 0xA6, 0x06, 0x08, 0xA6, 0x07, 0xAF, 0x46, 0x7E, 0x00, 0x78, 0x54, 0x12,
0x0B, 0xDA, 0xAD, 0x03, 0x7C, 0x00, 0x12, 0x05, 0x04, 0x78, 0x58, 0xA6, 0x06, 0x08, 0xA6, 0x07,
0xC3, 0x78, 0x5B, 0xE6, 0x94, 0x08, 0x18, 0xE6, 0x94, 0x00, 0x50, 0x05, 0x76, 0x00, 0x08, 0x76,
0x08, 0xC3, 0x78, 0x5D, 0xE6, 0x94, 0x08, 0x18, 0xE6, 0x94, 0x00, 0x50, 0x05, 0x76, 0x00, 0x08,
0x76, 0x08, 0x78, 0x5A, 0x12, 0x0B, 0xEA, 0xFF, 0xD3, 0x78, 0x57, 0xE6, 0x9F, 0x18, 0xE6, 0x9E,
0x40, 0x0E, 0x78, 0x5A, 0xE6, 0x13, 0xFE, 0x08, 0xE6, 0x78, 0x57, 0x12, 0x0C, 0x2C, 0x80, 0x04,
0x7E, 0x00, 0x7F, 0x00, 0x78, 0x5E, 0x12, 0x0B, 0xE2, 0xFF, 0xD3, 0x78, 0x59, 0xE6, 0x9F, 0x18,
0xE6, 0x9E, 0x40, 0x0E, 0x78, 0x5C, 0xE6, 0x13, 0xFE, 0x08, 0xE6, 0x78, 0x59, 0x12, 0x0C, 0x2C,
0x80, 0x04, 0x7E, 0x00, 0x7F, 0x00, 0xE4, 0xFC, 0xFD, 0x78, 0x62, 0x12, 0x06, 0xB7, 0x78, 0x5A,
0x12, 0x0B, 0xEA, 0x78, 0x57, 0x26, 0xFF, 0xEE, 0x18, 0x36, 0xFE, 0x78, 0x66, 0x12, 0x0B, 0xE2,
0x78, 0x59, 0x26, 0xFF, 0xEE, 0x18, 0x36, 0xFE, 0xE4, 0xFC, 0xFD, 0x78, 0x6A, 0x12, 0x06, 0xB7,
0x12, 0x0B, 0xF2, 0x78, 0x66, 0x12, 0x06, 0xAA, 0xD3, 0x12, 0x06, 0x76, 0x40, 0x08, 0x12, 0x0B,
0xF2, 0x78, 0x66, 0x12, 0x06, 0xB7, 0x78, 0x54, 0x12, 0x0B, 0xF4, 0x78, 0x6A, 0x12, 0x06, 0xAA,
0xD3, 0x12, 0x06, 0x76, 0x40, 0x0A, 0x78, 0x54, 0x12, 0x0B, 0xF4, 0x78, 0x6A, 0x12, 0x06, 0xB7,
0x78, 0x61, 0xE6, 0x90, 0x60, 0x01, 0xF0, 0x78, 0x65, 0xE6, 0xA3, 0xF0, 0x78, 0x69, 0xE6, 0xA3,
0xF0, 0x78, 0x55, 0xE6, 0xA3, 0xF0, 0x7D, 0x01, 0x78, 0x61, 0x12, 0x0C, 0x0D, 0x24, 0x01, 0x12,
0x0B, 0xCA, 0x78, 0x65, 0x12, 0x0C, 0x0D, 0x24, 0x02, 0x12, 0x0B, 0xCA, 0x78, 0x69, 0x12, 0x0C,
0x0D, 0x24, 0x03, 0x12, 0x0B, 0xCA, 0x78, 0x6D, 0x12, 0x0C, 0x0D, 0x24, 0x04, 0x12, 0x0B, 0xCA,
0x0D, 0xBD, 0x05, 0xD4, 0xC2, 0x0E, 0xC2, 0x06, 0x22, 0x85, 0x08, 0x41, 0x90, 0x30, 0x24, 0xE0,
0xF5, 0x3D, 0xA3, 0xE0, 0xF5, 0x3E, 0xA3, 0xE0, 0xF5, 0x3F, 0xA3, 0xE0, 0xF5, 0x40, 0xA3, 0xE0,
0xF5, 0x3C, 0xD2, 0x34, 0xE5, 0x41, 0x12, 0x06, 0xCF, 0x09, 0x4C, 0x03, 0x09, 0x50, 0x04, 0x09,
0x56, 0x05, 0x09, 0x59, 0x06, 0x09, 0x68, 0x07, 0x09, 0x71, 0x08, 0x09, 0x82, 0x12, 0x09, 0x9A,
0x18, 0x09, 0xB0, 0x19, 0x09, 0x85, 0x1A, 0x09, 0x91, 0x1B, 0x09, 0xD4, 0x80, 0x09, 0xD9, 0x81,
0x0A, 0x41, 0x8F, 0x0A, 0x30, 0x90, 0x0A, 0x41, 0x91, 0x0A, 0x41, 0x92, 0x0A, 0x41, 0x93, 0x0A,
0x41, 0x94, 0x0A, 0x41, 0x98, 0x0A, 0x3E, 0x9F, 0x00, 0x00, 0x0A, 0x5C, 0x12, 0x0E, 0xF8, 0x22,
0x12, 0x0E, 0xF8, 0xD2, 0x03, 0x22, 0xD2, 0x03, 0x22, 0xC2, 0x03, 0x30, 0x01, 0x03, 0x02, 0x0A,
0x5C, 0x20, 0x02, 0x03, 0x02, 0x0A, 0x41, 0x22, 0xA2, 0x37, 0xE4, 0x33, 0xF5, 0x3C, 0x02, 0x0A,
0x41, 0xC2, 0x01, 0xC2, 0x02, 0xC2, 0x03, 0x12, 0x0C, 0xB6, 0x75, 0x1E, 0x70, 0xD2, 0x35, 0x02,
0x0A, 0x41, 0x02, 0x0A, 0x2B, 0x85, 0x40, 0x4A, 0x85, 0x3C, 0x4B, 0x12, 0x0B, 0x23, 0x02, 0x0A,
0x41, 0x85, 0x4A, 0x40, 0x85, 0x4B, 0x3C, 0x02, 0x0A, 0x41, 0xE4, 0xF5, 0x22, 0xF5, 0x23, 0x85,
0x40, 0x31, 0x85, 0x3F, 0x30, 0x85, 0x3E, 0x2F, 0x85, 0x3D, 0x2E, 0x12, 0x0E, 0xCA, 0x80, 0x1F,
0x75, 0x22, 0x00, 0x75, 0x23, 0x01, 0x74, 0xFF, 0xF5, 0x2D, 0xF5, 0x2C, 0xF5, 0x2B, 0xF5, 0x2A,
0x12, 0x0E, 0xCA, 0x85, 0x2D, 0x40, 0x85, 0x2C, 0x3F, 0x85, 0x2B, 0x3E, 0x85, 0x2A, 0x3D, 0xE4,
0xF5, 0x3C, 0x80, 0x6D, 0x12, 0x0E, 0x9A, 0x80, 0x68, 0x85, 0x3D, 0x45, 0x85, 0x3E, 0x46, 0xE5,
0x47, 0xC3, 0x13, 0xFF, 0xE5, 0x45, 0xC3, 0x9F, 0x50, 0x02, 0x8F, 0x45, 0xE5, 0x48, 0xC3, 0x13,
0xFF, 0xE5, 0x46, 0xC3, 0x9F, 0x50, 0x02, 0x8F, 0x46, 0xE5, 0x47, 0xC3, 0x13, 0xFF, 0xFD, 0xE5,
0x45, 0x2D, 0xFD, 0xE4, 0x33, 0xFC, 0xE5, 0x44, 0x12, 0x0F, 0x14, 0x40, 0x05, 0xE5, 0x44, 0x9F,
0xF5, 0x45, 0xE5, 0x48, 0xC3, 0x13, 0xFF, 0xFD, 0xE5, 0x46, 0x2D, 0xFD, 0xE4, 0x33, 0xFC, 0xE5,
0x43, 0x12, 0x0F, 0x14, 0x40, 0x05, 0xE5, 0x43, 0x9F, 0xF5, 0x46, 0x12, 0x06, 0xF5, 0x80, 0x11,
0x85, 0x40, 0x48, 0x85, 0x3F, 0x47, 0x85, 0x3E, 0x46, 0x85, 0x3D, 0x45, 0x80, 0x03, 0x02, 0x06,
0xF5, 0x90, 0x30, 0x24, 0xE5, 0x3D, 0xF0, 0xA3, 0xE5, 0x3E, 0xF0, 0xA3, 0xE5, 0x3F, 0xF0, 0xA3,
0xE5, 0x40, 0xF0, 0xA3, 0xE5, 0x3C, 0xF0, 0x90, 0x30, 0x23, 0xE4, 0xF0, 0x22, 0xC0, 0xE0, 0xC0,
0x83, 0xC0, 0x82, 0xC0, 0xD0, 0x90, 0x3F, 0x0C, 0xE0, 0xF5, 0x32, 0xE5, 0x32, 0x30, 0xE3, 0x74,
0x30, 0x36, 0x66, 0x90, 0x60, 0x19, 0xE0, 0xF5, 0x0A, 0xA3, 0xE0, 0xF5, 0x0B, 0x90, 0x60, 0x1D,
0xE0, 0xF5, 0x14, 0xA3, 0xE0, 0xF5, 0x15, 0x90, 0x60, 0x21, 0xE0, 0xF5, 0x0C, 0xA3, 0xE0, 0xF5,
0x0D, 0x90, 0x60, 0x29, 0xE0, 0xF5, 0x0E, 0xA3, 0xE0, 0xF5, 0x0F, 0x90, 0x60, 0x31, 0xE0, 0xF5,
0x10, 0xA3, 0xE0, 0xF5, 0x11, 0x90, 0x60, 0x39, 0xE0, 0xF5, 0x12, 0xA3, 0xE0, 0xF5, 0x13, 0x30,
0x01, 0x06, 0x30, 0x33, 0x03, 0xD3, 0x80, 0x01, 0xC3, 0x92, 0x09, 0x30, 0x02, 0x06, 0x30, 0x33,
0x03, 0xD3, 0x80, 0x01, 0xC3, 0x92, 0x0A, 0x30, 0x33, 0x0C, 0x30, 0x03, 0x09, 0x20, 0x02, 0x06,
0x20, 0x01, 0x03, 0xD3, 0x80, 0x01, 0xC3, 0x92, 0x0B, 0x90, 0x30, 0x01, 0xE0, 0x44, 0x40, 0xF0,
0xE0, 0x54, 0xBF, 0xF0, 0xE5, 0x32, 0x30, 0xE1, 0x14, 0x30, 0x34, 0x11, 0x90, 0x30, 0x22, 0xE0,
0xF5, 0x08, 0xE4, 0xF0, 0x30, 0x00, 0x03, 0xD3, 0x80, 0x01, 0xC3, 0x92, 0x08, 0xE5, 0x32, 0x30,
0xE5, 0x12, 0x90, 0x56, 0xA1, 0xE0, 0xF5, 0x09, 0x30, 0x31, 0x09, 0x30, 0x05, 0x03, 0xD3, 0x80,
0x01, 0xC3, 0x92, 0x0D, 0x90, 0x3F, 0x0C, 0xE5, 0x32, 0xF0, 0xD0, 0xD0, 0xD0, 0x82, 0xD0, 0x83,
0xD0, 0xE0, 0x32, 0x90, 0x0E, 0x7E, 0xE4, 0x93, 0xFE, 0x74, 0x01, 0x93, 0xFF, 0xC3, 0x90, 0x0E,
0x7C, 0x74, 0x01, 0x93, 0x9F, 0xFF, 0xE4, 0x93, 0x9E, 0xFE, 0xE4, 0x8F, 0x3B, 0x8E, 0x3A, 0xF5,
0x39, 0xF5, 0x38, 0xAB, 0x3B, 0xAA, 0x3A, 0xA9, 0x39, 0xA8, 0x38, 0xAF, 0x4B, 0xFC, 0xFD, 0xFE,
0x12, 0x05, 0x59, 0x12, 0x0D, 0xE3, 0xE4, 0x7B, 0xFF, 0xFA, 0xF9, 0xF8, 0x12, 0x05, 0xE4, 0x12,
0x0D, 0xE3, 0x90, 0x0E, 0x69, 0xE4, 0x12, 0x0D, 0xF8, 0x12, 0x0D, 0xE3, 0xE4, 0x85, 0x4A, 0x37,
0xF5, 0x36, 0xF5, 0x35, 0xF5, 0x34, 0xAF, 0x37, 0xAE, 0x36, 0xAD, 0x35, 0xAC, 0x34, 0xA3, 0x12,
0x0D, 0xF8, 0x8F, 0x37, 0x8E, 0x36, 0x8D, 0x35, 0x8C, 0x34, 0xE5, 0x3B, 0x45, 0x37, 0xF5, 0x3B,
0xE5, 0x3A, 0x45, 0x36, 0xF5, 0x3A, 0xE5, 0x39, 0x45, 0x35, 0xF5, 0x39, 0xE5, 0x38, 0x45, 0x34,
0xF5, 0x38, 0xE4, 0xF5, 0x22, 0xF5, 0x23, 0x85, 0x3B, 0x31, 0x85, 0x3A, 0x30, 0x85, 0x39, 0x2F,
0x85, 0x38, 0x2E, 0x02, 0x0E, 0xCA, 0xE0, 0xA3, 0xE0, 0x75, 0xF0, 0x02, 0xA4, 0xFF, 0xAE, 0xF0,
0xC3, 0x08, 0xE6, 0x9F, 0xF6, 0x18, 0xE6, 0x9E, 0xF6, 0x22, 0xFF, 0xE5, 0xF0, 0x34, 0x60, 0x8F,
0x82, 0xF5, 0x83, 0xEC, 0xF0, 0x22, 0x78, 0x52, 0x7E, 0x00, 0xE6, 0xFC, 0x08, 0xE6, 0xFD, 0x02,
0x04, 0xF2, 0xE4, 0xFC, 0xFD, 0x12, 0x06, 0xB7, 0x78, 0x5C, 0xE6, 0xC3, 0x13, 0xFE, 0x08, 0xE6,
0x13, 0x22, 0x78, 0x52, 0xE6, 0xFE, 0x08, 0xE6, 0xFF, 0xE4, 0xFC, 0xFD, 0x22, 0xE7, 0xC4, 0xF8,
0x54, 0xF0, 0xC8, 0x68, 0xF7, 0x09, 0xE7, 0xC4, 0x54, 0x0F, 0x48, 0xF7, 0x22, 0xE6, 0xFC, 0xED,
0x75, 0xF0, 0x04, 0xA4, 0x22, 0x12, 0x06, 0x9A, 0x8F, 0x48, 0x8E, 0x47, 0x8D, 0x46, 0x8C, 0x45,
0x22, 0xE0, 0xFE, 0xA3, 0xE0, 0xFD, 0xEE, 0xF6, 0xED, 0x08, 0xF6, 0x22, 0x13, 0xFF, 0xC3, 0xE6,
0x9F, 0xFF, 0x18, 0xE6, 0x9E, 0xFE, 0x22, 0xE6, 0xC3, 0x13, 0xF7, 0x08, 0xE6, 0x13, 0x09, 0xF7,
0x22, 0x75, 0x89, 0x03, 0x75, 0xA8, 0x01, 0x75, 0xB8, 0x04, 0x75, 0x34, 0xFF, 0x75, 0x35, 0x0E,
0x75, 0x36, 0x15, 0x75, 0x37, 0x0D, 0x12, 0x0D, 0x27, 0x12, 0x00, 0x09, 0x12, 0x0E, 0x9A, 0x12,
0x00, 0x06, 0xD2, 0x00, 0xD2, 0x34, 0xD2, 0xAF, 0x75, 0x34, 0xFF, 0x75, 0x35, 0x0E, 0x75, 0x36,
0x49, 0x75, 0x37, 0x03, 0x12, 0x0D, 0x27, 0x30, 0x08, 0x09, 0xC2, 0x34, 0x12, 0x08, 0xE9, 0xC2,
0x08, 0xD2, 0x34, 0x30, 0x0B, 0x09, 0xC2, 0x36, 0x12, 0x02, 0x97, 0xC2, 0x0B, 0xD2, 0x36, 0x30,
0x09, 0x09, 0xC2, 0x36, 0x12, 0x00, 0x0E, 0xC2, 0x09, 0xD2, 0x36, 0x30, 0x0E, 0x03, 0x12, 0x06,
0xF5, 0x30, 0x35, 0xD3, 0x90, 0x30, 0x29, 0xE5, 0x1E, 0xF0, 0xB4, 0x10, 0x05, 0x90, 0x30, 0x23,
0xE4, 0xF0, 0xC2, 0x35, 0x80, 0xC1, 0xE4, 0xF5, 0x4B, 0x90, 0x0E, 0x7A, 0x93, 0xFF, 0xE4, 0x8F,
0x37, 0xF5, 0x36, 0xF5, 0x35, 0xF5, 0x34, 0xAF, 0x37, 0xAE, 0x36, 0xAD, 0x35, 0xAC, 0x34, 0x90,
0x0E, 0x6A, 0x12, 0x0D, 0xF8, 0x8F, 0x37, 0x8E, 0x36, 0x8D, 0x35, 0x8C, 0x34, 0x90, 0x0E, 0x72,
0x12, 0x06, 0x9A, 0xEF, 0x45, 0x37, 0xF5, 0x37, 0xEE, 0x45, 0x36, 0xF5, 0x36, 0xED, 0x45, 0x35,
0xF5, 0x35, 0xEC, 0x45, 0x34, 0xF5, 0x34, 0xE4, 0xF5, 0x22, 0xF5, 0x23, 0x85, 0x37, 0x31, 0x85,
0x36, 0x30, 0x85, 0x35, 0x2F, 0x85, 0x34, 0x2E, 0x12, 0x0E, 0xCA, 0xE4, 0xF5, 0x22, 0xF5, 0x23,
0x90, 0x0E, 0x72, 0x12, 0x0D, 0xEC, 0x12, 0x0E, 0xCA, 0xE4, 0xF5, 0x22, 0xF5, 0x23, 0x90, 0x0E,
0x6E, 0x12, 0x0D, 0xEC, 0x02, 0x0E, 0xCA, 0xAE, 0x35, 0xAF, 0x36, 0xE4, 0xFD, 0xED, 0xC3, 0x95,
0x37, 0x50, 0x33, 0x12, 0x0F, 0x4E, 0xE4, 0x93, 0xF5, 0x38, 0x74, 0x01, 0x93, 0xF5, 0x39, 0x45,
0x38, 0x60, 0x23, 0x85, 0x39, 0x82, 0x85, 0x38, 0x83, 0xE0, 0xFC, 0x12, 0x0F, 0x4E, 0x74, 0x03,
0x93, 0x52, 0x04, 0x12, 0x0F, 0x4E, 0x74, 0x02, 0x93, 0x42, 0x04, 0x85, 0x39, 0x82, 0x85, 0x38,
0x83, 0xEC, 0xF0, 0x0D, 0x80, 0xC7, 0x22, 0xE4, 0x93, 0xFF, 0x7E, 0x00, 0xE6, 0xFC, 0x08, 0xE6,
0xFD, 0x12, 0x04, 0xF2, 0xAC, 0x06, 0xAD, 0x07, 0x22, 0x90, 0x0E, 0x8C, 0xE4, 0x93, 0x25, 0xE0,
0x24, 0x0A, 0xF8, 0xE6, 0xFE, 0x08, 0xE6, 0xFF, 0x22, 0x78, 0x4E, 0xE6, 0xFE, 0x08, 0xE6, 0xFF,
0x22, 0xEF, 0x25, 0xE0, 0x24, 0x4E, 0xF8, 0xE6, 0xFC, 0x08, 0xE6, 0xFD, 0x22, 0x78, 0x89, 0xEF,
0x26, 0xF6, 0x18, 0xE4, 0x36, 0xF6, 0x22, 0x78, 0xBE, 0xE6, 0xD3, 0x08, 0xFF, 0xE6, 0x64, 0x80,
0xF8, 0xEF, 0x64, 0x80, 0x98, 0x22, 0x93, 0xFF, 0x7E, 0x00, 0xE6, 0xFC, 0x08, 0xE6, 0xFD, 0x12,
0x04, 0xF2, 0xAC, 0x06, 0xAD, 0x07, 0x78, 0xB6, 0xE6, 0xFE, 0x08, 0xE6, 0x78, 0x03, 0x22, 0x78,
0xBD, 0xD3, 0xE6, 0x64, 0x80, 0x94, 0x80, 0x22, 0x25, 0xE0, 0x24, 0x0A, 0xF8, 0xE6, 0xFE, 0x08,
0xE6, 0xFF, 0x22, 0x8F, 0x3B, 0x8E, 0x3A, 0x8D, 0x39, 0x8C, 0x38, 0x22, 0x12, 0x06, 0x9A, 0x8F,
0x31, 0x8E, 0x30, 0x8D, 0x2F, 0x8C, 0x2E, 0x22, 0x93, 0xF9, 0xF8, 0x02, 0x06, 0x87, 0x00, 0x00,
0x12, 0x03, 0x06, 0x13, 0x44, 0x31, 0x4F, 0x56, 0x54, 0x20, 0x20, 0x20, 0x20, 0x20, 0x22, 0x01,
0x10, 0x00, 0x56, 0x40, 0x1A, 0x30, 0x29, 0x7E, 0x00, 0x30, 0x04, 0x20, 0xDF, 0x30, 0x05, 0x40,
0xBF, 0x50, 0x03, 0x00, 0xFD, 0x50, 0x27, 0x01, 0xFE, 0x60, 0x00, 0x11, 0x00, 0x3F, 0x05, 0x30,
0x00, 0x3F, 0x06, 0x22, 0x00, 0x3F, 0x01, 0x2A, 0x00, 0x3F, 0x02, 0x00, 0x00, 0x36, 0x06, 0x07,
0x00, 0x3F, 0x0B, 0x0F, 0xF0, 0x00, 0x00, 0x00, 0x00, 0x30, 0x01, 0x40, 0xBF, 0x30, 0x01, 0x00,
0xBF, 0x30, 0x29, 0x70, 0x00, 0x3A, 0x00, 0x00, 0xFF, 0x3A, 0x00, 0x00, 0xFF, 0x36, 0x03, 0x36,
0x02, 0x41, 0x44, 0x58, 0x20, 0x18, 0x10, 0x0A, 0x04, 0x04, 0x00, 0x03, 0xFF, 0x64, 0x00, 0x00,
0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x02, 0x04, 0x06, 0x06, 0x00, 0x03, 0x51, 0x00, 0x7A,
0x50, 0x3C, 0x28, 0x1E, 0x10, 0x10, 0x50, 0x2D, 0x28, 0x16, 0x10, 0x10, 0x02, 0x00, 0x40, 0x12,
0x18, 0x04, 0x0C, 0x6E, 0x30, 0x28, 0x00, 0xA5, 0x5A, 0x00, 0xE5, 0x3C, 0xD3, 0x94, 0x00, 0x40,
0x0B, 0x90, 0x0E, 0x88, 0x12, 0x0C, 0x15, 0x90, 0x0E, 0x86, 0x80, 0x09, 0x90, 0x0E, 0x82, 0x12,
0x0C, 0x15, 0x90, 0x0E, 0x80, 0xE4, 0x93, 0xF5, 0x44, 0xA3, 0xE4, 0x93, 0xF5, 0x43, 0xD2, 0x06,
0x30, 0x06, 0x03, 0xD3, 0x80, 0x01, 0xC3, 0x92, 0x0E, 0x22, 0xA2, 0xAF, 0x92, 0x32, 0xC2, 0xAF,
0xE5, 0x23, 0x45, 0x22, 0x90, 0x0E, 0x5D, 0x60, 0x0E, 0x12, 0x0F, 0x37, 0xE0, 0xF5, 0x2C, 0x12,
0x0F, 0x34, 0xE0, 0xF5, 0x2D, 0x80, 0x0C, 0x12, 0x0F, 0x37, 0xE5, 0x30, 0xF0, 0x12, 0x0F, 0x34,
0xE5, 0x31, 0xF0, 0xA2, 0x32, 0x92, 0xAF, 0x22, 0xD2, 0x01, 0xC2, 0x02, 0xE4, 0xF5, 0x1F, 0xF5,
0x1E, 0xD2, 0x35, 0xD2, 0x33, 0xD2, 0x36, 0xD2, 0x01, 0xC2, 0x02, 0xF5, 0x1F, 0xF5, 0x1E, 0xD2,
0x35, 0xD2, 0x33, 0x22, 0xFB, 0xD3, 0xED, 0x9B, 0x74, 0x80, 0xF8, 0x6C, 0x98, 0x22, 0xC0, 0xE0,
0xC0, 0x83, 0xC0, 0x82, 0x90, 0x3F, 0x0D, 0xE0, 0xF5, 0x33, 0xE5, 0x33, 0xF0, 0xD0, 0x82, 0xD0,
0x83, 0xD0, 0xE0, 0x32, 0x90, 0x0E, 0x5F, 0xE4, 0x93, 0xFE, 0x74, 0x01, 0x93, 0xF5, 0x82, 0x8E,
0x83, 0x22, 0x78, 0x7F, 0xE4, 0xF6, 0xD8, 0xFD, 0x75, 0x81, 0xCD, 0x02, 0x0C, 0x41, 0x8F, 0x82,
0x8E, 0x83, 0x75, 0xF0, 0x04, 0xED, 0x02, 0x06, 0xC3
};

static struct ov5640_reg lock_3A[] = {
    {OV5640_WRITE_REG_DATA8, 0x3503, 0x07},
    {OV5640_WRITE_REG_DATA8, 0x3406, 0x01},
    //{OV5640_WAIT_MS, 0x0000, 10},
    {OV5640_TABLE_END, 0x0000}
};

static struct ov5640_reg unlock_3A[] = {
    {OV5640_WRITE_REG_DATA8, 0x3503, 0x00},
    {OV5640_WRITE_REG_DATA8, 0x3406, 0x00},
    //{OV5640_WAIT_MS, 0x0000, 10},
    {OV5640_TABLE_END, 0x0000}
};
#if 0
static struct ov5640_reg ColorEffect_None[] = {
    {OV5640_TABLE_END, 0x0000}
};

static struct ov5640_reg ColorEffect_Aqua[] = {
    {OV5640_TABLE_END, 0x0000}
};

static struct ov5640_reg ColorEffect_Mono[] = {
    {OV5640_TABLE_END, 0x0000}
};

static struct ov5640_reg ColorEffect_Sepia[] = {
    {OV5640_TABLE_END, 0x0000}
};

static struct ov5640_reg ColorEffect_Negative[] = {
    {OV5640_TABLE_END, 0x0000}
};

static struct ov5640_reg ColorEffect_Solarize[] = {
    {OV5640_TABLE_END, 0x0000}
};

static struct ov5640_reg ColorEffect_Posterize[] = {
    {OV5640_TABLE_END, 0x0000}
};

static struct ov5640_reg ColorEffect_Blackboard[] = {
    {OV5640_TABLE_END, 0x0000}
};

static struct ov5640_reg ColorEffect_Whiteboard[] = {
    {OV5640_TABLE_END, 0x0000}
};
#endif

static struct ov5640_reg WhiteBalance_Sunlight[] = {
    {OV5640_WRITE_REG_DATA8, 0x3406, 0x01},
    {OV5640_WRITE_REG_DATA8, 0x3400, 0x07},
    {OV5640_WRITE_REG_DATA8, 0x3401, 0x0E},
    {OV5640_WRITE_REG_DATA8, 0x3402, 0x04},
    {OV5640_WRITE_REG_DATA8, 0x3403, 0x00},
    {OV5640_WRITE_REG_DATA8, 0x3404, 0x04},
    {OV5640_WRITE_REG_DATA8, 0x3405, 0xA2},
    {OV5640_TABLE_END, 0x0000, 0x00}
};

static struct ov5640_reg WhiteBalance_Cloudy[] = {
    {OV5640_WRITE_REG_DATA8, 0x3406, 0x01},
    {OV5640_WRITE_REG_DATA8, 0x3400, 0x07},
    {OV5640_WRITE_REG_DATA8, 0x3401, 0x48},
    {OV5640_WRITE_REG_DATA8, 0x3402, 0x04},
    {OV5640_WRITE_REG_DATA8, 0x3403, 0x00},
    {OV5640_WRITE_REG_DATA8, 0x3404, 0x04},
    {OV5640_WRITE_REG_DATA8, 0x3405, 0xD3},
    {OV5640_TABLE_END, 0x0000, 0x00}
};
static struct ov5640_reg WhiteBalance_Incandescent[] = {
    {OV5640_WRITE_REG_DATA8, 0x3406, 0x01},
    {OV5640_WRITE_REG_DATA8, 0x3400, 0x04},
    {OV5640_WRITE_REG_DATA8, 0x3401, 0x99},
    {OV5640_WRITE_REG_DATA8, 0x3402, 0x04},
    {OV5640_WRITE_REG_DATA8, 0x3403, 0x00},
    {OV5640_WRITE_REG_DATA8, 0x3404, 0x08},
    {OV5640_WRITE_REG_DATA8, 0x3405, 0x79},
    {OV5640_TABLE_END, 0x0000, 0x00}
};

static struct ov5640_reg WhiteBalance_Fluorescent[] = {
    {OV5640_WRITE_REG_DATA8, 0x3406, 0x01},
    {OV5640_WRITE_REG_DATA8, 0x3400, 0x06},
    {OV5640_WRITE_REG_DATA8, 0x3401, 0x2B},
    {OV5640_WRITE_REG_DATA8, 0x3402, 0x04},
    {OV5640_WRITE_REG_DATA8, 0x3403, 0x00},
    {OV5640_WRITE_REG_DATA8, 0x3404, 0x07},
    {OV5640_WRITE_REG_DATA8, 0x3405, 0xB6},
    {OV5640_TABLE_END, 0x0000, 0x00}
};

static struct ov5640_reg WhiteBalance_Auto[] = {
    {OV5640_WRITE_REG_DATA8, 0x3406, 0x00},
    {OV5640_TABLE_END, 0x0000, 0x00}
};

static struct ov5640_reg WhiteBalance_Shade[] = {
    {OV5640_TABLE_END, 0x0000, 0x0000}
};

static struct ov5640_reg WhiteBalance_Tungsten[] = {
    {OV5640_TABLE_END, 0x0000, 0x0000}
};

static struct ov5640_reg WhiteBalance_Flash[] = {
    {OV5640_TABLE_END, 0x0000, 0x0000}
};

static struct ov5640_reg WhiteBalance_Horizon[] = {
    {OV5640_TABLE_END, 0x0000, 0x0000}
};

static struct ov5640_reg WhiteBalance_WarmFluorescent[] = {
    {OV5640_TABLE_END, 0x0000, 0x0000}
};

static struct ov5640_reg WhiteBalance_Twilight[] = {
    {OV5640_TABLE_END, 0x0000, 0x0000}
};

static struct ov5640_reg exp_negative3[] = {
    {OV5640_WRITE_REG_DATA8, 0x3A0F, 0x18},
    {OV5640_WRITE_REG_DATA8, 0x3A10, 0x10},
    {OV5640_WRITE_REG_DATA8, 0x3A11, 0x30},
    {OV5640_WRITE_REG_DATA8, 0x3A1B, 0x18},
    {OV5640_WRITE_REG_DATA8, 0x3A1E, 0x10},
    {OV5640_WRITE_REG_DATA8, 0x3A1F, 0x10},
    {OV5640_TABLE_END, 0x0000, 0x00}
};

static struct ov5640_reg exp_negative2[] = {
    {OV5640_WRITE_REG_DATA8, 0x3A0F, 0x20},
    {OV5640_WRITE_REG_DATA8, 0x3A10, 0x18},
    {OV5640_WRITE_REG_DATA8, 0x3A11, 0x41},
    {OV5640_WRITE_REG_DATA8, 0x3A1B, 0x20},
    {OV5640_WRITE_REG_DATA8, 0x3A1E, 0x18},
    {OV5640_WRITE_REG_DATA8, 0x3A1F, 0x10},
    {OV5640_TABLE_END, 0x0000, 0x00}
};

static struct ov5640_reg exp_negative1[] = {
    {OV5640_WRITE_REG_DATA8, 0x3A0F, 0x2C},
    {OV5640_WRITE_REG_DATA8, 0x3A10, 0x24},
    {OV5640_WRITE_REG_DATA8, 0x3A11, 0x51},
    {OV5640_WRITE_REG_DATA8, 0x3A1B, 0x2C},
    {OV5640_WRITE_REG_DATA8, 0x3A1E, 0x24},
    {OV5640_WRITE_REG_DATA8, 0x3A1F, 0x10},
    {OV5640_TABLE_END, 0x0000, 0x00}
};

static struct ov5640_reg exp_zero[] = {
    {OV5640_WRITE_REG_DATA8, 0x3A0F, 0x32},
    {OV5640_WRITE_REG_DATA8, 0x3A10, 0x2C},
    {OV5640_WRITE_REG_DATA8, 0x3A11, 0x61},
    {OV5640_WRITE_REG_DATA8, 0x3A1B, 0x32},
    {OV5640_WRITE_REG_DATA8, 0x3A1E, 0x2C},
    {OV5640_WRITE_REG_DATA8, 0x3A1F, 0x10},
    {OV5640_TABLE_END, 0x0000, 0x00}
};

static struct ov5640_reg exp_one[] = {
    {OV5640_WRITE_REG_DATA8, 0x3A0F, 0x44},
    {OV5640_WRITE_REG_DATA8, 0x3A10, 0x3C},
    {OV5640_WRITE_REG_DATA8, 0x3A11, 0x80},
    {OV5640_WRITE_REG_DATA8, 0x3A1B, 0x44},
    {OV5640_WRITE_REG_DATA8, 0x3A1E, 0x3C},
    {OV5640_WRITE_REG_DATA8, 0x3A1F, 0x20},
    {OV5640_TABLE_END, 0x0000, 0x00}
};

static struct ov5640_reg exp_two[] = {
    {OV5640_WRITE_REG_DATA8, 0x3A0F, 0x58},
    {OV5640_WRITE_REG_DATA8, 0x3A10, 0x50},
    {OV5640_WRITE_REG_DATA8, 0x3A11, 0x91},
    {OV5640_WRITE_REG_DATA8, 0x3A1B, 0x58},
    {OV5640_WRITE_REG_DATA8, 0x3A1E, 0x50},
    {OV5640_WRITE_REG_DATA8, 0x3A1F, 0x20},
    {OV5640_TABLE_END, 0x0000, 0x00}
};

static struct ov5640_reg exp_three[] = {
    {OV5640_WRITE_REG_DATA8, 0x3A0F, 0x68},
    {OV5640_WRITE_REG_DATA8, 0x3A10, 0x60},
    {OV5640_WRITE_REG_DATA8, 0x3A11, 0xA0},
    {OV5640_WRITE_REG_DATA8, 0x3A1B, 0x68},
    {OV5640_WRITE_REG_DATA8, 0x3A1E, 0x60},
    {OV5640_WRITE_REG_DATA8, 0x3A1F, 0x20},
    {OV5640_TABLE_END, 0x0000, 0x00}
};

static struct ov5640_reg scene_auto[] = {
    {OV5640_WRITE_REG_DATA8, 0x3A00, 0x7C},
    {OV5640_WRITE_REG_DATA8, 0x3010, 0x00},
    {OV5640_WRITE_REG_DATA8, 0x3A02, 0x09},
    {OV5640_WRITE_REG_DATA8, 0x3A03, 0x9C},
    {OV5640_WRITE_REG_DATA8, 0x3A14, 0x09},
    {OV5640_WRITE_REG_DATA8, 0x3A15, 0x9C},
    {OV5640_WRITE_REG_DATA8, 0x3A17, 0x02},
    {OV5640_WRITE_REG_DATA8, 0x5001, 0x9F},
    {OV5640_WRITE_REG_DATA8, 0x5580, 0x02},
    {OV5640_WRITE_REG_DATA8, 0x5583, 0x40},
    {OV5640_WRITE_REG_DATA8, 0x5584, 0x40},
    {OV5640_WRITE_REG_DATA8, 0x5587, 0x20},
    {OV5640_WRITE_REG_DATA8, 0x5588, 0x20},
    {OV5640_WRITE_REG_DATA8, 0x530C, 0x00},
    {OV5640_WRITE_REG_DATA8, 0x530D, 0x0C},
    {OV5640_WRITE_REG_DATA8, 0x5312, 0x40},
    {OV5640_TABLE_END, 0x0000, 0x00}
};

/*The action mode adopts the sport setting*/
static struct ov5640_reg scene_action[] = {
    {OV5640_WRITE_REG_DATA8, 0x3A00, 0x78},
    {OV5640_WRITE_REG_DATA8, 0x3010, 0x00},
    {OV5640_WRITE_REG_DATA8, 0x5001, 0x9F},
    {OV5640_WRITE_REG_DATA8, 0x5580, 0x06},
    {OV5640_WRITE_REG_DATA8, 0x5583, 0x40},
    {OV5640_WRITE_REG_DATA8, 0x5584, 0x40},
    {OV5640_WRITE_REG_DATA8, 0x5587, 0x24},
    {OV5640_WRITE_REG_DATA8, 0x5588, 0x24},
    {OV5640_WRITE_REG_DATA8, 0x530C, 0x00},
    {OV5640_WRITE_REG_DATA8, 0x530D, 0x14},
    {OV5640_WRITE_REG_DATA8, 0x5312, 0x30},
    {OV5640_TABLE_END, 0x0000, 0x00}
};

static struct ov5640_reg scene_sport[] = {
    {OV5640_WRITE_REG_DATA8, 0x3A00, 0x78},
    {OV5640_WRITE_REG_DATA8, 0x3010, 0x00},
    {OV5640_WRITE_REG_DATA8, 0x5001, 0x9F},
    {OV5640_WRITE_REG_DATA8, 0x5580, 0x06},
    {OV5640_WRITE_REG_DATA8, 0x5583, 0x40},
    {OV5640_WRITE_REG_DATA8, 0x5584, 0x40},
    {OV5640_WRITE_REG_DATA8, 0x5587, 0x24},
    {OV5640_WRITE_REG_DATA8, 0x5588, 0x24},
    {OV5640_WRITE_REG_DATA8, 0x530C, 0x00},
    {OV5640_WRITE_REG_DATA8, 0x530D, 0x14},
    {OV5640_WRITE_REG_DATA8, 0x5312, 0x30},
    {OV5640_TABLE_END, 0x0000, 0x00}
};

static struct ov5640_reg scene_portrait[] = {
    {OV5640_WRITE_REG_DATA8, 0x3A00, 0x78},
    {OV5640_WRITE_REG_DATA8, 0x3010, 0x00},
    {OV5640_WRITE_REG_DATA8, 0x5001, 0x9F},
    {OV5640_WRITE_REG_DATA8, 0x5580, 0x02},
    {OV5640_WRITE_REG_DATA8, 0x5583, 0x3C},
    {OV5640_WRITE_REG_DATA8, 0x5584, 0x3C},
    {OV5640_WRITE_REG_DATA8, 0x5587, 0x20},
    {OV5640_WRITE_REG_DATA8, 0x5588, 0x20},
    {OV5640_WRITE_REG_DATA8, 0x530C, 0x00},
    {OV5640_WRITE_REG_DATA8, 0x530D, 0x08},
    {OV5640_WRITE_REG_DATA8, 0x5312, 0x40},
    {OV5640_TABLE_END, 0x0000, 0x00}
};

static struct ov5640_reg scene_landscape[] = {
    {OV5640_WRITE_REG_DATA8, 0x3A00, 0x78},
    {OV5640_WRITE_REG_DATA8, 0x3010, 0x00},
    {OV5640_WRITE_REG_DATA8, 0x5001, 0x9F},
    {OV5640_WRITE_REG_DATA8, 0x5580, 0x06},
    {OV5640_WRITE_REG_DATA8, 0x5583, 0x48},
    {OV5640_WRITE_REG_DATA8, 0x5584, 0x48},
    {OV5640_WRITE_REG_DATA8, 0x5587, 0x24},
    {OV5640_WRITE_REG_DATA8, 0x5588, 0x24},
    {OV5640_WRITE_REG_DATA8, 0x530C, 0x04},
    {OV5640_WRITE_REG_DATA8, 0x530D, 0x18},
    {OV5640_WRITE_REG_DATA8, 0x5312, 0x20},
    {OV5640_TABLE_END, 0x0000, 0x00}
};

static struct ov5640_reg scene_night[] = {
    {OV5640_WRITE_REG_DATA8, 0x3A00, 0x7C},
    {OV5640_WRITE_REG_DATA8, 0x3A02, 0x3D},
    {OV5640_WRITE_REG_DATA8, 0x3A03, 0x80},
    {OV5640_WRITE_REG_DATA8, 0x3A14, 0x0E},
    {OV5640_WRITE_REG_DATA8, 0x3A15, 0x40},
    {OV5640_WRITE_REG_DATA8, 0x3010, 0x10},
    {OV5640_WRITE_REG_DATA8, 0x5001, 0xDF},
    {OV5640_WRITE_REG_DATA8, 0x5580, 0x02},
    {OV5640_WRITE_REG_DATA8, 0x5583, 0x40},
    {OV5640_WRITE_REG_DATA8, 0x5584, 0x40},
    {OV5640_WRITE_REG_DATA8, 0x5587, 0x20},
    {OV5640_WRITE_REG_DATA8, 0x5588, 0x20},
    {OV5640_WRITE_REG_DATA8, 0x530C, 0x00},
    {OV5640_WRITE_REG_DATA8, 0x530D, 0x08},
    {OV5640_WRITE_REG_DATA8, 0x5312, 0x40},
    {OV5640_TABLE_END, 0x0000, 0x00}
};

static struct ov5640_reg scene_nightportrait[] = {
    {OV5640_TABLE_END, 0x0000, 0x00}
};

static struct ov5640_reg scene_theatre[] = {
    {OV5640_TABLE_END, 0x0000, 0x00}
};

static struct ov5640_reg scene_beach[] = {
    {OV5640_WRITE_REG_DATA8, 0x3A00, 0x78},
    {OV5640_WRITE_REG_DATA8, 0x3010, 0x00},
    {OV5640_WRITE_REG_DATA8, 0x5001, 0x9F},
    {OV5640_WRITE_REG_DATA8, 0x5580, 0x06},
    {OV5640_WRITE_REG_DATA8, 0x5583, 0x48},
    {OV5640_WRITE_REG_DATA8, 0x5584, 0x48},
    {OV5640_WRITE_REG_DATA8, 0x5587, 0x1C},
    {OV5640_WRITE_REG_DATA8, 0x5588, 0x1C},
    {OV5640_WRITE_REG_DATA8, 0x530C, 0x02},
    {OV5640_WRITE_REG_DATA8, 0x530D, 0x10},
    {OV5640_WRITE_REG_DATA8, 0x5312, 0x30},
    {OV5640_TABLE_END, 0x0000, 0x00}
};

static struct ov5640_reg scene_snow[] = {
    {OV5640_WRITE_REG_DATA8, 0x3A00, 0x78},
    {OV5640_WRITE_REG_DATA8, 0x3010, 0x00},
    {OV5640_WRITE_REG_DATA8, 0x5001, 0x9F},
    {OV5640_WRITE_REG_DATA8, 0x5580, 0x06},
    {OV5640_WRITE_REG_DATA8, 0x5583, 0x48},
    {OV5640_WRITE_REG_DATA8, 0x5584, 0x48},
    {OV5640_WRITE_REG_DATA8, 0x5587, 0x1C},
    {OV5640_WRITE_REG_DATA8, 0x5588, 0x1C},
    {OV5640_WRITE_REG_DATA8, 0x530C, 0x02},
    {OV5640_WRITE_REG_DATA8, 0x530D, 0x10},
    {OV5640_WRITE_REG_DATA8, 0x5312, 0x30},
    {OV5640_TABLE_END, 0x0000, 0x00}
};

static struct ov5640_reg scene_sunset[] = {
    {OV5640_WRITE_REG_DATA8, 0x3A00, 0x78},
    {OV5640_WRITE_REG_DATA8, 0x3010, 0x00},
    {OV5640_WRITE_REG_DATA8, 0x5001, 0x9F},
    {OV5640_WRITE_REG_DATA8, 0x5580, 0x02},
    {OV5640_WRITE_REG_DATA8, 0x5583, 0x48},
    {OV5640_WRITE_REG_DATA8, 0x5584, 0x4C},
    {OV5640_WRITE_REG_DATA8, 0x5587, 0x20},
    {OV5640_WRITE_REG_DATA8, 0x5588, 0x20},
    {OV5640_WRITE_REG_DATA8, 0x530C, 0x00},
    {OV5640_WRITE_REG_DATA8, 0x530D, 0x0C},
    {OV5640_WRITE_REG_DATA8, 0x5312, 0x40},
    {OV5640_TABLE_END, 0x0000, 0x00}
};

static struct ov5640_reg scene_steadyphoto[] = {
    {OV5640_TABLE_END, 0x0000, 0x00}
};

static struct ov5640_reg scene_candlelight[] = {
    {OV5640_WRITE_REG_DATA8, 0x3A01, 0x78},
    {OV5640_WRITE_REG_DATA8, 0x3010, 0x00},
    {OV5640_WRITE_REG_DATA8, 0x5001, 0x9F},
    {OV5640_WRITE_REG_DATA8, 0x5580, 0x02},
    {OV5640_WRITE_REG_DATA8, 0x5583, 0x34},
    {OV5640_WRITE_REG_DATA8, 0x5584, 0x38},
    {OV5640_WRITE_REG_DATA8, 0x5587, 0x20},
    {OV5640_WRITE_REG_DATA8, 0x5588, 0x20},
    {OV5640_WRITE_REG_DATA8, 0x530C, 0x00},
    {OV5640_WRITE_REG_DATA8, 0x530D, 0x08},
    {OV5640_WRITE_REG_DATA8, 0x5312, 0x40},
    {OV5640_TABLE_END, 0x0000, 0x00}
};

static struct ov5640_reg scene_barcode[] = {
    {OV5640_WRITE_REG_DATA8, 0x3A01, 0x78},
    {OV5640_WRITE_REG_DATA8, 0x3010, 0x00},
    {OV5640_WRITE_REG_DATA8, 0x5001, 0x9F},
    {OV5640_WRITE_REG_DATA8, 0x5580, 0x06},
    {OV5640_WRITE_REG_DATA8, 0x5583, 0x40},
    {OV5640_WRITE_REG_DATA8, 0x5584, 0x40},
    {OV5640_WRITE_REG_DATA8, 0x5587, 0x24},
    {OV5640_WRITE_REG_DATA8, 0x5588, 0x24},
    {OV5640_WRITE_REG_DATA8, 0x530C, 0x02},
    {OV5640_WRITE_REG_DATA8, 0x530D, 0x12},
    {OV5640_WRITE_REG_DATA8, 0x5312, 0x30},
    {OV5640_TABLE_END, 0x0000, 0x00}
};

static struct ov5640_reg scene_backlight[] = {
    {OV5640_TABLE_END, 0x0000, 0x00}
};

static struct ov5640_reg scene_fireworks[] = {
    {OV5640_WRITE_REG_DATA8, 0x3A01, 0x01},
    {OV5640_WRITE_REG_DATA8, 0x3010, 0x08},
    {OV5640_WRITE_REG_DATA8, 0x5001, 0x9F},
    {OV5640_WRITE_REG_DATA8, 0x5580, 0x02},
    {OV5640_WRITE_REG_DATA8, 0x5583, 0x40},
    {OV5640_WRITE_REG_DATA8, 0x5584, 0x40},
    {OV5640_WRITE_REG_DATA8, 0x5587, 0x20},
    {OV5640_WRITE_REG_DATA8, 0x5588, 0x20},
    {OV5640_WRITE_REG_DATA8, 0x530C, 0x00},
    {OV5640_WRITE_REG_DATA8, 0x530D, 0x08},
    {OV5640_WRITE_REG_DATA8, 0x5312, 0x40},
    {OV5640_TABLE_END, 0x0000, 0x00}
};

static struct ov5640_reg scene_party[] = {
    {OV5640_WRITE_REG_DATA8, 0x3A00, 0x78},
    {OV5640_WRITE_REG_DATA8, 0x3010, 0x00},
    {OV5640_WRITE_REG_DATA8, 0x5001, 0xDF},
    {OV5640_WRITE_REG_DATA8, 0x5580, 0x02},
    {OV5640_WRITE_REG_DATA8, 0x5583, 0x40},
    {OV5640_WRITE_REG_DATA8, 0x5584, 0x40},
    {OV5640_WRITE_REG_DATA8, 0x5587, 0x20},
    {OV5640_WRITE_REG_DATA8, 0x5588, 0x20},
    {OV5640_WRITE_REG_DATA8, 0x530C, 0x00},
    {OV5640_WRITE_REG_DATA8, 0x530D, 0x08},
    {OV5640_WRITE_REG_DATA8, 0x5312, 0x40},
    {OV5640_TABLE_END, 0x0000, 0x00}
};

static struct ov5640_reg af_macro[] = {
    {OV5640_WRITE_REG_DATA8, OV5640_AF_CMD_ACK_REG, 0x01},         // Pause auto focus
    {OV5640_WRITE_REG_DATA8, OV5640_AF_CMD_MAIN_REG, 0x06},
    //{POLL_REG_BIT, OV5640_AF_CMD_ACK_REG, 0x00},
    {OV5640_WAIT_MS, 0x0000, 10},
    {OV5640_WRITE_REG_DATA8, 0x3603, 0x2F},
    {OV5640_WRITE_REG_DATA8, 0x3602, 0x00},
    //{POLL_REG_BIT, OV5640_AF_CMD_ACK_REG, 0x00},
    {OV5640_WAIT_MS, 0x0000, 10},
    {OV5640_WRITE_REG_DATA8, OV5640_AF_CMD_ACK_REG, 0x01},         // Trigger Auto focus
    {OV5640_WRITE_REG_DATA8, OV5640_AF_CMD_MAIN_REG, 0x03},
    //{POLL_REG_BIT, OV5640_AF_CMD_ACK_REG, 0x00},
    {OV5640_WAIT_MS, 0x0000, 10},
    {OV5640_TABLE_END, 0x0000, 0x00}
};

static struct ov5640_reg af_infinity[] = {
    {OV5640_WRITE_REG_DATA8, OV5640_AF_CMD_ACK_REG, 0x01},         // Release focus
    {OV5640_WRITE_REG_DATA8, OV5640_AF_CMD_MAIN_REG, 0x08},
    //{POLL_REG_BIT, OV5640_AF_CMD_ACK_REG, 0x00},
    {OV5640_WAIT_MS, 0x0000, 10},
    {OV5640_TABLE_END, 0x0000, 0x00}
};

static struct ov5640_reg full_trigger[] = {
    {OV5640_WRITE_REG_DATA8, OV5640_AF_CMD_ACK_REG, 0x01},         // Pause auto focus
    {OV5640_WRITE_REG_DATA8, OV5640_AF_CMD_MAIN_REG, 0x06},
    //{POLL_REG_BIT, OV5640_AF_CMD_ACK_REG, 0x00},
    {OV5640_WAIT_MS, 0x0000, 10},
    {OV5640_WRITE_REG_DATA8, OV5640_AF_CMD_ACK_REG, 0x01},         // Launch default focus zone
    {OV5640_WRITE_REG_DATA8, OV5640_AF_CMD_MAIN_REG, 0x80},
    //{POLL_REG_BIT, OV5640_AF_CMD_ACK_REG, 0x00},
    {OV5640_WAIT_MS, 0x0000, 10},
    {OV5640_WRITE_REG_DATA8, OV5640_AF_CMD_ACK_REG, 0x01},         // Trigger Auto focus
    {OV5640_WRITE_REG_DATA8, OV5640_AF_CMD_MAIN_REG, 0x03},
    //{POLL_REG_BIT, OV5640_AF_CMD_ACK_REG, 0x00},
    {OV5640_WAIT_MS, 0x0000, 10},
    {OV5640_TABLE_END, 0x0000, 0x00}
};

static struct ov5640_reg continuous_af[] = {
    {OV5640_WRITE_REG_DATA8, OV5640_AF_CMD_ACK_REG, 0x01},         // Pause auto focus
    {OV5640_WRITE_REG_DATA8, OV5640_AF_CMD_MAIN_REG, 0x06},
    //{POLL_REG_BIT, OV5640_AF_CMD_ACK_REG, 0x00},
    {OV5640_WAIT_MS, 0x0000, 10},
    {OV5640_WRITE_REG_DATA8, OV5640_AF_CMD_ACK_REG, 0x01},         // Continuous auto focus
    {OV5640_WRITE_REG_DATA8, OV5640_AF_CMD_MAIN_REG, 0x04},
    //{POLL_REG_BIT, OV5640_AF_CMD_ACK_REG, 0x00},
    {OV5640_WAIT_MS, 0x0000, 10},
    {OV5640_TABLE_END, 0x0000, 0x00}
};

static struct ov5640_reg af_mode_trigger_on[] = {
    {OV5640_WRITE_REG_DATA8, OV5640_AF_CMD_ACK_REG, 0x01},         // Trigger Auto focus
    {OV5640_WRITE_REG_DATA8, OV5640_AF_CMD_MAIN_REG, 0x03},
    //{POLL_REG_BIT, OV5640_AF_CMD_ACK_REG, 0x00},
    {OV5640_WAIT_MS, 0x0000, 10},
    {OV5640_TABLE_END, 0x0000, 0x00}
};

static struct ov5640_reg af_mode_trigger_off[] = {
    {OV5640_WRITE_REG_DATA8, OV5640_AF_CMD_ACK_REG, 0x01},         // Pause auto focus
    {OV5640_WRITE_REG_DATA8, OV5640_AF_CMD_MAIN_REG, 0x06},
    //{POLL_REG_BIT, OV5640_AF_CMD_ACK_REG, 0x00},
    {OV5640_WAIT_MS, 0x0000, 10},
    {OV5640_TABLE_END, 0x0000, 0x00}
};

static struct ov5640_reg flash_auto[] = {
    {OV5640_TABLE_END, 0x0000, 0x00}
};
static struct ov5640_reg flash_on[] = {
    {OV5640_TABLE_END, 0x0000, 0x00}
};

enum {
    OV5640_MODE_2592x1944,
    OV5640_MODE_1920x1080,
    OV5640_MODE_1280x960,
};

static struct ov5640_reg *mode_table[] = {
    [OV5640_MODE_2592x1944]  = mode_2592x1944,
    [OV5640_MODE_1920x1080]  = mode_1920x1080,
    [OV5640_MODE_1280x960]   = mode_1280x960,
};

static struct ov5640_reg *af_mode_table[] = {
    [OV5640_FocusMode_Auto]        = full_trigger,
    [OV5640_FocusMode_Infinity]    = af_infinity,
    [OV5640_FocusMode_Macro]       = af_macro,
    [OV5640_FocusMode_Hyperfocal]  = af_macro,
    [OV5640_FocusMode_Fixed]       = af_infinity,
    [OV5640_FocusMode_Continuous_Video]    = continuous_af,
    [OV5640_FocusMode_Continuous_Picture]  = continuous_af,
};

static struct ov5640_reg *wb_mode_table[] = {
    [OV5640_WhiteBalance_Sunlight] = WhiteBalance_Sunlight,
    [OV5640_WhiteBalance_Cloudy] = WhiteBalance_Cloudy,
    [OV5640_WhiteBalance_Shade] = WhiteBalance_Shade,
    [OV5640_WhiteBalance_Tungsten] = WhiteBalance_Tungsten,
    [OV5640_WhiteBalance_Incandescent] = WhiteBalance_Incandescent,
    [OV5640_WhiteBalance_Fluorescent] = WhiteBalance_Fluorescent,
    [OV5640_WhiteBalance_Flash] = WhiteBalance_Flash,
    [OV5640_WhiteBalance_Horizon] = WhiteBalance_Horizon,
    [OV5640_WhiteBalance_WarmFluorescent] = WhiteBalance_WarmFluorescent,
    [OV5640_WhiteBalance_Twilight] = WhiteBalance_Twilight,
    [OV5640_WhiteBalance_Auto] = WhiteBalance_Auto,
};

static struct ov5640_reg *exposure_table[] = {
    [OV5640_Exposure_Negative_3] = exp_negative3,
    [OV5640_Exposure_Negative_2] = exp_negative2,
    [OV5640_Exposure_Negative_1] = exp_negative1,
    [OV5640_Exposure_0] = exp_zero,
    [OV5640_Exposure_1] = exp_one,
    [OV5640_Exposure_2] = exp_two,
    [OV5640_Exposure_3] = exp_three,
};
#if 0
static struct ov5640_reg *color_effect_mode_table[] = {
    [OV5640_ColorEffect_Aqua] = ColorEffect_Aqua,
    [OV5640_ColorEffect_Blackboard] = ColorEffect_Blackboard,
    [OV5640_ColorEffect_Mono] = ColorEffect_Mono,
    [OV5640_ColorEffect_Negative] = ColorEffect_Negative,
    [OV5640_ColorEffect_None] = ColorEffect_None,
    [OV5640_ColorEffect_Posterize] = ColorEffect_Posterize,
    [OV5640_ColorEffect_Sepia] = ColorEffect_Sepia,
    [OV5640_ColorEffect_Solarize] = ColorEffect_Solarize,
    [OV5640_ColorEffect_Whiteboard] = ColorEffect_Whiteboard,
};
#endif
static struct ov5640_reg *scene_mode_table[] = {
    [OV5640_SceneMode_Auto] = scene_auto,
    [OV5640_SceneMode_Action] = scene_action,
    [OV5640_SceneMode_Portrait] = scene_portrait,
    [OV5640_SceneMode_Landscape] = scene_landscape,
    [OV5640_SceneMode_Beach] = scene_beach,
    [OV5640_SceneMode_Candlelight] = scene_candlelight,
    [OV5640_SceneMode_Fireworks] = scene_fireworks,
    [OV5640_SceneMode_Night] = scene_night,
    [OV5640_SceneMode_NightPortrait] = scene_nightportrait,
    [OV5640_SceneMode_Party] = scene_party,
    [OV5640_SceneMode_Snow] = scene_snow,
    [OV5640_SceneMode_Sports] = scene_sport,
    [OV5640_SceneMode_SteadyPhoto] = scene_steadyphoto,
    [OV5640_SceneMode_Sunset] = scene_sunset,
    [OV5640_SceneMode_Theatre] = scene_theatre,
    [OV5640_SceneMode_Barcode] = scene_barcode,
    [OV5640_SceneMode_Backlight] = scene_backlight,
};

static struct ov5640_reg WhiteBalance_Flash_default[] = {
    {OV5640_WRITE_REG_DATA8, 0x3406, 0x01},
    {OV5640_WRITE_REG_DATA8, 0x3400, 0x07},
    {OV5640_WRITE_REG_DATA8, 0x3401, 0xc0},
    {OV5640_WRITE_REG_DATA8, 0x3402, 0x04},
    {OV5640_WRITE_REG_DATA8, 0x3403, 0x00},
    {OV5640_WRITE_REG_DATA8, 0x3404, 0x05},
    {OV5640_WRITE_REG_DATA8, 0x3405, 0x70},
    {OV5640_TABLE_END, 0x0000, 0x00}
};

static struct ov5640_reg WhiteBalance_Flash_1[] = {
    {OV5640_WRITE_REG_DATA8, 0x3406, 0x01},
    {OV5640_WRITE_REG_DATA8, 0x3400, 0x06},
    {OV5640_WRITE_REG_DATA8, 0x3401, 0xC0},
    {OV5640_WRITE_REG_DATA8, 0x3402, 0x04},
    {OV5640_WRITE_REG_DATA8, 0x3403, 0x00},
    {OV5640_WRITE_REG_DATA8, 0x3404, 0x05},
    {OV5640_WRITE_REG_DATA8, 0x3405, 0x70},
    {OV5640_TABLE_END, 0x0000, 0x00}
};

static int ov5640_read_reg8(struct i2c_client *client, u16 addr, u8 *val)
{
	int err;
	struct i2c_msg msg[2];
	unsigned char data[3];

	if (!client->adapter)
		return -ENODEV;

	msg[0].addr = client->addr;
	msg[0].flags = 0;
	msg[0].len = 2;
	msg[0].buf = data;

	/* high byte goes out first */
	data[0] = (u8) (addr >> 8);
	data[1] = (u8) (addr & 0xff);

	msg[1].addr = client->addr;
	msg[1].flags = I2C_M_RD;
	msg[1].len = 1;
	msg[1].buf = data + 2;

	err = i2c_transfer(client->adapter, msg, 2);

	if (err != 2)

		return -EINVAL;

	*val = data[2];

	return 0;
}

static int ov5640_read_reg16(struct i2c_client *client, u16 addr, u16 *val)
{
    int err;
    struct i2c_msg msg[2];
    unsigned char data[4];

    if (!client->adapter) return -ENODEV;

    msg[0].addr = client->addr;
    msg[0].flags = 0;
    msg[0].len = 2;
    msg[0].buf = data;

    /* high byte goes out first */
    data[0] = (u8) (addr >> 8);;
    data[1] = (u8) (addr & 0xff);

    msg[1].addr = client->addr;
    msg[1].flags = I2C_M_RD;
    msg[1].len = 2;
    msg[1].buf = data;

    err = i2c_transfer(client->adapter, msg, 2);

    if (err != 2) return -EINVAL;

    *val = (data[0]<<8) | data[1];

    return 0;
}

static int ov5640_write_reg8(struct i2c_client *client, u16 addr, u8 val)
{
	int err;
	struct i2c_msg msg;
	unsigned char data[3];
	int retry = 0;

	if (!client->adapter)
		return -ENODEV;

	data[0] = (u8) (addr >> 8);;
	data[1] = (u8) (addr & 0xff);
	data[2] = (u8) (val & 0xff);

	msg.addr = client->addr;
	msg.flags = 0;
	msg.len = 3;
	msg.buf = data;

	do {
		err = i2c_transfer(client->adapter, &msg, 1);
		if (err == 1)
			return 0;
		retry++;
		pr_err("ov5640: i2c transfer failed, retrying %x %x\n",
		       addr, val);

		msleep(3);
	} while (retry <= OV5640_MAX_RETRIES);

	return err;
}

static int ov5640_write_buf(struct i2c_client *client, u16 addr, u8 *buf, int len)
{
    int err = 0;
    struct i2c_msg msg;
    u8 *data;
    int retry = 0;

    if (!client->adapter) return -ENODEV;

    data = kmalloc(len+2, GFP_KERNEL);
    if (!data) {
        pr_err("%s: Cannot allocate memory for data!!!\n", __func__);
        return -ENOMEM;
    }

    memset(data, 0, len+2);

    data[0] = (u8) (addr >> 8);
    data[1] = (u8) (addr & 0xff);

    memcpy(&data[2], buf, len);

    msg.addr = client->addr;
    msg.flags = 0;
    msg.len = len+2;
    msg.buf = data;
    do {
        err = i2c_transfer(client->adapter, &msg, 1);
        if (err == 1) return 0;
        retry++;
        pr_err("ov5640 : i2c transfer failed, retrying 0x%x\n",
                addr);
        msleep(3);
    } while (retry <= OV5640_MAX_RETRIES);

    kfree(data);

    return err;
}

static int ov5640_poll(struct i2c_client *client, u16 addr, u8 value, u8 mask)
{
    u8 data;
    int try_times, err;
    int try_error;

    try_error = 0;
    for (try_times = 0; try_times < OV5640_POLL_RETRIES; try_times++) {
        err = ov5640_read_reg8(client, addr, &data);

        if (err) {
            if ((try_error++)<10) {
                msleep(100);
                continue;
            }else
                return err;
        }

        pr_info("poll reg 0x%x: 0x%x == 0x%x & 0x%x %d times\n", addr, value, data, mask, try_times);
        if (value == (data & mask)) return 0;
    }
    pr_err("%s: poll for %d times 0x%x == ([0x%x]=0x%x) & 0x%x failed\n", __func__,
            try_times, value, addr, data, mask);

    return -EIO;
}

static int ov5640_poll_bit_set(struct i2c_client *client, u16 addr, u8 bit)
{
    return ov5640_poll(client, addr, bit, bit);
}

static int ov5640_write_table(struct i2c_client *client,
			      const struct ov5640_reg table[])
{
    int err;
    const struct ov5640_reg *next;

    for (next = table; next->op != OV5640_TABLE_END; next++) {
        switch (next->op) {
            case OV5640_WRITE_REG_DATA8:
                err = ov5640_write_reg8(client, next->addr, next->val);
                if (err) return err;
                break;
            case OV5640_POLL_REG_BIT:
                err = ov5640_poll_bit_set(client, next->addr, next->val);
                if (err) return err;
                break;
            case OV5640_WAIT_MS:
                msleep(next->val);
                break;
            default:
                pr_err("%s: Invalid operation 0x%x!!!\n", __func__, next->op);
                break;
        }
    }

    return 0;
}

static int ov5640_get_status(struct ov5640_info *info, u16 *status)
{
    int err;

    *status = 0;
    err = ov5640_read_reg16(info->i2c_client, OV5640_MODEL_ID_REG_ADDR, status);
    if (err) return err;

    if (*status == OV5640_MODEL_ID_REG_VALUE)
        printk("ov5640: module_id= 0x%x\n", *status);
    else
        printk(KERN_ERR "%s: FAILED to get module_id, err: %x\n", __func__, err);

    return 0;
}

static int ov5640_get_af_status(struct ov5640_info *info)
{
    int err;
    u8 val;

    err = ov5640_read_reg8(info->i2c_client, OV5640_AF_FW_STATUS_REG, &val);
    if (err) return err;

    pr_info("%s: value %x \n", __func__, val);

    return val;
}

static int ov5640_set_wb_mode(struct ov5640_info *info, u8 mode)
{
    int err;

    pr_info("%s: wb mode %d\n", __func__, mode);
    if (mode < OV5640_WhiteBalance_None)
    {
        err = ov5640_write_table(info->i2c_client, wb_mode_table[mode]);
        if (err) return err;

        pre_wb_mode = mode;
    }
    else
        pr_err("%s: unsupport wb mode!!!\n", __func__);

    return 0;
}

static int ov5640_set_exposure(struct ov5640_info *info, u8 exposure)
{
    int err;

    pr_info("%s: exposure enum %d\n", __func__, exposure);
    if (exposure < OV5640_Exposure_Max)
    {
        err = ov5640_write_table(info->i2c_client, exposure_table[exposure]);
        if (err) return err;

        pre_exposure = exposure;
    }
    else
        pr_err("%s: unsupport exposure setting!!!\n", __func__);

    return 0;
}

static int ov5640_set_color_effect(struct ov5640_info *info, u8 color_effect)
{
#if 0
    int err;

    pr_info("%s: color effect %d\n", __func__, color_effect);

    err = ov5640_write_table(info->i2c_client, color_effect_mode_table[color_effect]);
    if (err) return err;
#endif
    return 0;
}

static int ov5640_set_scene(struct ov5640_info *info, u8 scene)
{
    int err;

    pr_info("%s: scene mode %d\n", __func__, scene);

    if (scene < OV5640_SceneMode_Max)
    {
        if (scene != OV5640_SceneMode_Auto) {
            err = ov5640_write_table(info->i2c_client, wb_mode_table[OV5640_WhiteBalance_Auto]);
            if (err) return err;
        }

        err = ov5640_write_table(info->i2c_client, scene_mode_table[scene]);
        if (err) return err;

        pre_scene = scene;
    }
    else
        pr_err("%s: unsupport scene mode!!!\n", __func__);

    return 0;
}

static int ov5640_load_af_fw(struct ov5640_info *info)
{
    int ret;
    int len = sizeof(ov5640_af_fw) / sizeof(ov5640_af_fw[0]);

    ret = ov5640_write_reg8(info->i2c_client, 0x3000, 0x20);
    if (ret) goto load_fail;

    ret = ov5640_write_buf(info->i2c_client, 0x8000, ov5640_af_fw, len);
    if (ret) goto load_fail;

    ret = ov5640_write_reg8(info->i2c_client, OV5640_AF_CMD_MAIN_REG, 0x00);
    if (ret) goto load_fail;
    ret = ov5640_write_reg8(info->i2c_client, OV5640_AF_CMD_ACK_REG, 0x00);
    if (ret) goto load_fail;
    ret = ov5640_write_reg8(info->i2c_client, OV5640_AF_CMD_PARA0_REG, 0x00);
    if (ret) goto load_fail;
    ret = ov5640_write_reg8(info->i2c_client, OV5640_AF_CMD_PARA1_REG, 0x00);
    if (ret) goto load_fail;
    ret = ov5640_write_reg8(info->i2c_client, OV5640_AF_CMD_PARA2_REG, 0x00);
    if (ret) goto load_fail;
    ret = ov5640_write_reg8(info->i2c_client, OV5640_AF_CMD_PARA3_REG, 0x00);
    if (ret) goto load_fail;
    ret = ov5640_write_reg8(info->i2c_client, OV5640_AF_CMD_PARA4_REG, 0x00);
    if (ret) goto load_fail;
    ret = ov5640_write_reg8(info->i2c_client, OV5640_AF_FW_STATUS_REG, 0x7F);
    if (ret) goto load_fail;
    ret = ov5640_write_reg8(info->i2c_client, 0x3000, 0x00);
    if (ret) goto load_fail;

    ret = ov5640_write_reg8(info->i2c_client, OV5640_AF_CMD_ACK_REG, 0x01);
    if (ret) goto load_fail;
    ret = ov5640_write_reg8(info->i2c_client, OV5640_AF_CMD_MAIN_REG, 0x04);
    if (ret) goto load_fail;

    return 0;

load_fail:
    pr_err("%s: load AF firmware fail\n", __func__);
    return ret;
}

static int ov5640_set_af_mode(struct ov5640_info *info, u8 mode)
{
    int err;

    pr_info("%s: focus mode %d\n", __func__, mode);
    if(mode < OV5640_FocusMode_Max)
    {
        err = ov5640_write_table(info->i2c_client, af_mode_table[mode]);
        if (err) return err;

        pre_focus_mode = mode;
    }
    else
        pr_err("%s: unsupport focus mode!!!\n", __func__);

    return 0;
}

static int ov5640_set_af_trigger(struct ov5640_info *info, u8 trigger)
{
    int err;

    pr_info("%s: trigger %d\n", __func__, trigger);

    if (trigger == 0)
        err = ov5640_write_table(info->i2c_client, af_mode_trigger_off);
    else
        err = ov5640_write_table(info->i2c_client, af_mode_trigger_on);

    if (err) return err;

    return 0;
}

static int ov5640_set_af_window_touch_mode(struct ov5640_info *info, struct ov5640_af_window window)
{
    int err;
    struct ov5640_reg set_window_table[] = {
        {OV5640_WRITE_REG_DATA8, OV5640_AF_CMD_PARA0_REG, (u8)window.x_center_pos},
        {OV5640_WRITE_REG_DATA8, OV5640_AF_CMD_PARA1_REG, (u8)window.y_center_pos},
        {OV5640_WRITE_REG_DATA8, OV5640_AF_CMD_ACK_REG, 0x01},
        {OV5640_WRITE_REG_DATA8, OV5640_AF_CMD_MAIN_REG, OV5640_AF_DATA_LAUNCH_TOUCH_FOCUS_ZONE},
        //{OV5640_POLL_REG_BIT, OV5640_AF_CMD_ACK_REG, 0x00},
        {OV5640_WAIT_MS, 0x0000, 10},
        {OV5640_TABLE_END, 0x0000, 0x00}
    };

    pr_info("%s: touch focus window (%d, %d)\n", __func__, window.x_center_pos, window.y_center_pos);
    err = ov5640_write_table(info->i2c_client, set_window_table);
    if (err) return err;

    return 0;
}

static int ov5640_set_af_window_cust_mode(struct ov5640_info *info, struct ov5640_af_window window)
{
    int err;
    struct ov5640_reg set_window_table[] = {
        {OV5640_WRITE_REG_DATA8, OV5640_AF_CMD_ACK_REG, 0x01},
        {OV5640_WRITE_REG_DATA8, OV5640_AF_CMD_MAIN_REG, OV5640_AF_DATA_ENABLE_CUST_FOCUS_ZONE},
        //{OV5640_POLL_REG_BIT, OV5640_AF_CMD_ACK_REG, 0x00},
        {OV5640_WAIT_MS, 0x0000, 10},
        {OV5640_WRITE_REG_DATA8, OV5640_AF_CMD_PARA0_REG, (u8)window.x_center_pos},
        {OV5640_WRITE_REG_DATA8, OV5640_AF_CMD_PARA1_REG, (u8)window.y_center_pos},
        {OV5640_WRITE_REG_DATA8, OV5640_AF_CMD_PARA2_REG, (u8)window.x_size},
        {OV5640_WRITE_REG_DATA8, OV5640_AF_CMD_PARA3_REG, (u8)window.y_size},
        {OV5640_WRITE_REG_DATA8, OV5640_AF_CMD_ACK_REG, 0x01},
        {OV5640_WRITE_REG_DATA8, OV5640_AF_CMD_MAIN_REG, OV5640_AF_DATA_CONFIGURE_FOCUS_ZONE_0},
        //{OV5640_POLL_REG_BIT, OV5640_AF_CMD_ACK_REG, 0x00},
        {OV5640_WAIT_MS, 0x0000, 10},
        {OV5640_WRITE_REG_DATA8, OV5640_AF_CMD_ACK_REG, 0x01},
        {OV5640_WRITE_REG_DATA8, OV5640_AF_CMD_MAIN_REG, OV5640_AF_DATA_LAUNCH_CUST_FOCUS_ZONE},
        //{OV5640_POLL_REG_BIT, OV5640_AF_CMD_ACK_REG, 0x00},
        {OV5640_WAIT_MS, 0x0000, 10},
        {OV5640_TABLE_END, 0x0000, 0x00}
    };

    pr_info("%s: cust focus window (%d, %d, %d, %d)\n", __func__, window.x_center_pos, window.y_center_pos,
            window.x_size, window.y_size);
    err = ov5640_write_table(info->i2c_client, set_window_table);
    if (err) return err;

    return 0;
}

static int ov5640_set_wb_flash(struct ov5640_info *info, u8 mode)
{
    int ret= 0;
    printk("ov5640_set_wb_flash-mode: %d\n", mode);

    switch( mode)
    {
        case 0 :
            ret= ov5640_write_table(info->i2c_client, WhiteBalance_Flash_default);
            break;
        case 1 :
            ret= ov5640_write_table(info->i2c_client, WhiteBalance_Flash_1);
            break;
        default :
            ret= ov5640_write_table(info->i2c_client, WhiteBalance_Flash_default);
            break;
    }
    return ret;
}

static int ov5640_set_mode(struct ov5640_info *info, struct ov5640_mode *mode)
{
    int sensor_mode;
    int err;
    pr_info("%s: xres %u yres %u\n",__func__, mode->xres, mode->yres);

    if (mode->xres == 2592 && mode->yres == 1944)
        sensor_mode = OV5640_MODE_2592x1944;
    else if (mode->xres == 1920 && mode->yres == 1080)
	 sensor_mode = OV5640_MODE_1920x1080;
    else if (mode->xres == 1280 && mode->yres == 960)
        sensor_mode = OV5640_MODE_1280x960;
    else{
        pr_err("%s: invalid resolution supplied to set mode %d %d\n",__func__, mode->xres, mode->yres);
        return -EINVAL;
    }

    if (!initial) {
        pr_info("%s: do sw reset\n", __func__);
        err = ov5640_write_reg8(info->i2c_client, 0x3008, 0x82);
        if (err) return err;
    }

    pr_info("%s: write sensor mode table %d\n", __func__, sensor_mode);
    err = ov5640_write_table(info->i2c_client, mode_table[sensor_mode]);
    if (err) return err;

    pr_info("%s: write IQ_table\n", __func__);
    err = ov5640_write_table(info->i2c_client, IQ_table);
    if (err) return err;

    if (!initial) {
	 pr_info("%s: re-config wb mode %d\n", __func__, pre_wb_mode);
        err = ov5640_set_wb_mode(info, pre_wb_mode);
        if (err) return err;

        pr_info("%s: load AF FW\n", __func__);
        err = ov5640_load_af_fw(info);;
        if (err) return err;
    }
    if (!initial) initial = 1;

    if(sensor_mode == OV5640_MODE_1280x960 || sensor_mode == OV5640_MODE_1920x1080)
    {
        pr_info("%s: re-config focus mode %d\n", __func__, pre_focus_mode);
        err = ov5640_set_af_mode(info, pre_focus_mode);
        if (err) return err;
    }

    info->mode = sensor_mode;

    return 0;
}

static long ov5640_ioctl(struct file *file,
            unsigned int cmd, unsigned long arg)
{
    struct ov5640_info *info = file->private_data;
    int err = 0;

    switch (cmd)
    {
        case OV5640_IOCTL_SET_MODE:
        {
            struct ov5640_mode mode;
            if (copy_from_user(&mode, (const void __user *)arg, sizeof(struct ov5640_mode)))
                return -EFAULT;

            return ov5640_set_mode(info, &mode);
        }
        case OV5640_IOCTL_SET_3A_LOCK:
        {
            u8 lock;

            if (copy_from_user(&lock, (const void __user *)arg, sizeof(lock)))
                return -EFAULT;
            pr_info("ov5640 LOCK_3A %d\n", lock);
            if (lock == 0)
            {
		  err = ov5640_write_table(info->i2c_client, unlock_3A);
                if (err) return err;

		  if ((pre_scene == OV5640_SceneMode_Auto) && (pre_wb_mode != OV5640_WhiteBalance_None))
		  {
		      pr_info("%s: re-config wb mode %d\n", __func__, pre_wb_mode);
		      err = ov5640_set_wb_mode(info, pre_wb_mode);
		      if (err) return err;
		  }

                pr_info("%s: re-config focus mode %d\n", __func__, pre_focus_mode);
                err = ov5640_set_af_mode(info, pre_focus_mode);
                if (err) return err;
            }
            else
            {
                err = ov5640_write_table(info->i2c_client, lock_3A);
                if (err) return err;
            }
            return 0;
        }
        case OV5640_IOCTL_GET_STATUS:
        {
            u16 status;

            err = ov5640_get_status(info, &status);
            if (err) return err;

            if (copy_to_user((void __user *)arg, &status, 1))
                return -EFAULT;

            return 0;
        }
        case OV5640_IOCTL_GET_BRIGHTNESS:
        {
            u8 val= 0;

            err = ov5640_read_reg8(info->i2c_client, 0x56A1, &val);
            if (err) return err;

            if (copy_to_user((void __user *)arg, &val,1))
                return -EFAULT;

            return 0;
        }
        case OV5640_IOCTL_SET_FLASH_MODE:
        {
            if(arg == OV5640_FlashAuto)
                err = ov5640_write_table(info->i2c_client, flash_auto);
            if(arg == OV5640_FlashOn)
                err = ov5640_write_table(info->i2c_client, flash_on);

            if (err) return err;

            return 0;
        }
        case OV5640_IOCTL_GET_AF_STATUS:
        {
            return ov5640_get_af_status(info);
        }
        case OV5640_IOCTL_SET_AF_MODE:
        {
            pr_info("ov5640 SET_AF_MODE %d\n", (u8)arg);
            return ov5640_set_af_mode(info, (u8)arg);
        }
        case OV5640_IOCTL_SET_AF_TRIGGER:
        {
            pr_info("ov5640 SET_AF_TRIGGER %d\n", (u8)arg);
            return ov5640_set_af_trigger(info, (u8)arg);
        }
        case OV5640_IOCTL_SET_AF_WINDOW_TOUCH_MODE:
        {
            struct ov5640_af_window window;

            pr_info("ov5640 SET_AF_WINDOW_TOUCH_MODE \n");
            if (copy_from_user(&window, (const void __user *)arg, sizeof(struct ov5640_af_window)))
                return -EFAULT;

            return ov5640_set_af_window_touch_mode(info, window);
        }
        case OV5640_IOCTL_SET_AF_WINDOW_CUST_MODE:
        {
            struct ov5640_af_window window;

            pr_info("ov5640 SET_AF_WINDOW_CUST_MODE \n");
            if (copy_from_user(&window, (const void __user *)arg, sizeof(struct ov5640_af_window)))
                return -EFAULT;

            return ov5640_set_af_window_cust_mode(info, window);
        }
        case OV5640_IOCTL_SET_COLOR_EFFECT:
        {
            u8 coloreffect;

            if (copy_from_user(&coloreffect, (const void __user *)arg, sizeof(coloreffect)))
                return -EFAULT;
            pr_info("ov5640 SET_COLOR_EFFECT %d\n", coloreffect);
            err = ov5640_set_color_effect(info, coloreffect);
            if (err) return err;

            return 0;
        }
        case OV5640_IOCTL_SET_WHITE_BALANCE:
        {
            u8 whitebalance;

            if (copy_from_user(&whitebalance, (const void __user *)arg, sizeof(whitebalance))) {
                return -EFAULT;
            }
            pr_info("ov5640 SET_WHITE_BALANCE %d\n", whitebalance);
            err = ov5640_set_wb_mode(info, whitebalance);
            if (err) return err;

            return 0;
        }
        case OV5640_IOCTL_SET_SCENE_MODE:
        {
            u8 scenemode;

            if (copy_from_user(&scenemode, (const void __user *)arg, sizeof(scenemode))) {
                return -EFAULT;
            }
            pr_info("ov5640 SET_SCENE_MODE %d\n", scenemode);
            err = ov5640_set_scene(info, scenemode);
            if (err) return err;

            return 0;
        }
        case OV5640_IOCTL_SET_EXPOSURE:
        {
            u8 exposure = (u8)(((int)arg)+3);
            pr_info("ov5640 SET_EXPOSURE %d\n", (int)arg);
            err = ov5640_set_exposure(info, exposure);
            if (err) return err;

            return 0;
        }
        case OV5640_IOCTL_SET_WHITE_BALANCE_FLASH:
        {
            return ov5640_set_wb_flash(info, (u8)arg);
        }
        default:
            return -EINVAL;
    }
    return 0;
}

static struct ov5640_info *info;

/* Below two API are required only for power management is enbled */
static int ov5640_suspend(void)
{
    int ret;
    u8 tmp_reg;

    // hardware standby mode, power down MIPI control
    pr_info("%s\n", __func__);

    ret = ov5640_read_reg8(info->i2c_client, 0x300E, &tmp_reg);
    if (ret)
        return ret;

    ret = ov5640_write_reg8(info->i2c_client, 0x300E, (tmp_reg | 0x18));
    if (ret)
        return ret;

    //check the bit of standby
    ret = ov5640_read_reg8(info->i2c_client, 0x300E, &tmp_reg);

    if((tmp_reg & 0x18) != 0x18 )
    {
        printk(KERN_ERR "%s : %s(%d), power down MIPI control fail\n", __FILE__, __func__, __LINE__);
        if (ret)
            return ret;
    }
    return 0;
}

static int ov5640_resume(void)
{
    int ret;
    u8 tmp_reg = 0;

    pr_info("%s\n", __func__);

    ret = ov5640_read_reg8(info->i2c_client, 0x3008, &tmp_reg);
    if (ret)
        return ret;

    ret = ov5640_write_reg8(info->i2c_client, 0x3008, (tmp_reg & ~0x40));
    if (ret)
        return ret;

    //check the bit of standby
    ret = ov5640_read_reg8(info->i2c_client, 0x3008, &tmp_reg);

    if((tmp_reg & 0x40) != 0 )
    {
        printk(KERN_ERR "%s : %s(%d), standby fail\n", __FILE__, __func__, __LINE__);
        if (ret)
            return ret;
    }

    //hardware standby mode, clear power down MIPI control
    tmp_reg = 0;
    ret = ov5640_read_reg8(info->i2c_client, 0x300E, &tmp_reg);
    if (ret)
        return ret;

    ret = ov5640_write_reg8(info->i2c_client, 0x300E, (tmp_reg & ~0x18));
    if (ret)
        return ret;

    //check the bit of standby
    ret = ov5640_read_reg8(info->i2c_client, 0x300E, &tmp_reg);

    if((tmp_reg & 0x18) != 0 )
    {
        printk(KERN_ERR "%s : %s(%d), standby fail\n", __FILE__, __func__, __LINE__);
        if (ret)
            return ret;
    }
    return 0;
}

static int ov5640_open(struct inode *inode, struct file *file)
{
    int err;
    u16 status;
    pr_info("%s++\n", __func__);

    file->private_data = info;
    if (info->pdata && info->pdata->power_on)
        info->pdata->power_on(&info->power);

    err = ov5640_get_status(info, &status);
    if (err) return err;

    err = ov5640_resume();
    if (err) return err;

    initial = 0;

    pr_info("%s--\n", __func__);
    return 0;
}

int ov5640_release(struct inode *inode, struct file *file)
{
    int err;
    pr_info("%s++\n", __func__);

    err = ov5640_suspend();
    if (err) return err;

    if (info->pdata && info->pdata->power_off)
        info->pdata->power_off(&info->power);
    file->private_data = NULL;

    initial = 0;

    return 0;
}

static int ov5640_power_put(struct ov5640_power_rail *pw)
{
    if (likely(pw->dvdd))
        regulator_put(pw->dvdd);

    if (likely(pw->avdd))
        regulator_put(pw->avdd);

    pw->dvdd = NULL;
    pw->avdd = NULL;

    return 0;
}

static int ov5640_regulator_get(struct ov5640_info *info,
	struct regulator **vreg, char vreg_name[])
{
    struct regulator *reg = NULL;
    int err = 0;

    reg = regulator_get(&info->i2c_client->dev, vreg_name);
    if (unlikely(IS_ERR(reg))) {
        dev_err(&info->i2c_client->dev, "%s %s ERR: %d\n",
            __func__, vreg_name, (int)reg);
        err = PTR_ERR(reg);
        reg = NULL;
    } else
        dev_dbg(&info->i2c_client->dev, "%s: %s\n",
            __func__, vreg_name);

    *vreg = reg;
    return err;
}

static int ov5640_power_get(struct ov5640_info *info)
{
    struct ov5640_power_rail *pw = &info->power;

    ov5640_regulator_get(info, &pw->dvdd, "pri_cam_1v8"); // digital 1.8v
    ov5640_regulator_get(info, &pw->avdd, "pri_cam_2v8"); // analog 2.8v

    return 0;
}

static const struct file_operations ov5640_fileops = {
    .owner = THIS_MODULE,
    .open = ov5640_open,
    .unlocked_ioctl = ov5640_ioctl,
    .release = ov5640_release,
};

static struct miscdevice ov5640_device = {
    .minor = MISC_DYNAMIC_MINOR,
    .name = OV5640_SENSOR_NAME,
    .fops = &ov5640_fileops,
};

static int ov5640_probe(struct i2c_client *client,
			const struct i2c_device_id *id)
{
    int err;
    pr_info("%s++\n", __func__);
    info = kzalloc(sizeof(struct ov5640_info), GFP_KERNEL);
    if (!info) {
        pr_err("ov5640: Unable to allocate memory!\n");
        return -ENOMEM;
    }

    info->pdata = client->dev.platform_data;
    info->i2c_client = client;
    info->mode = -1;

    i2c_set_clientdata(client, info);

    ov5640_power_get(info);

    err = misc_register(&ov5640_device);
    if (err) {
        ov5640_power_put(&info->power);
        pr_err("ov5640: Unable to register misc device!\n");
        kfree(info);
        return err;
    }

    return 0;
}

static int ov5640_remove(struct i2c_client *client)
{
    struct ov5640_info *info;
    info = i2c_get_clientdata(client);
    ov5640_power_put(&info->power);
    misc_deregister(&ov5640_device);
    kfree(info);
    return 0;
}

static const struct i2c_device_id ov5640_id[] = {
    { OV5640_SENSOR_NAME, 0 },
    { },
};

MODULE_DEVICE_TABLE(i2c, ov5640_id);

static struct i2c_driver ov5640_i2c_driver = {
    .driver = {
        .name = OV5640_SENSOR_NAME,
        .owner = THIS_MODULE,
    },
    .probe = ov5640_probe,
    .remove = ov5640_remove,
    .id_table = ov5640_id,
};

static int __init ov5640_init(void)
{
    return i2c_add_driver(&ov5640_i2c_driver);
}

static void __exit ov5640_exit(void)
{
    i2c_del_driver(&ov5640_i2c_driver);
}

module_init(ov5640_init);
module_exit(ov5640_exit);

